;---------------------------------------------------------------------------
;Karasu Stand
[Statedef 40000]
type = S
physics = S
sprpriority = 0
velset = 0,0
ctrl = 0
anim = 40000

[State 0, ParentVarSet]
type = ParentVarSet
trigger1 = time = 0
v = 10
value = 1

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
v = 0
value = 4

[State 0, PowerAdd]
type = PowerAdd
trigger1 = timemod = 5,0
value = -1

[State 0, Turn]
type = Turn
trigger1 = pos x > enemynear(cond((enemynear(0),alive),0,1)), pos x && facing = 1
trigger2 = pos x < enemynear(cond((enemynear(0),alive),0,1)), pos x && facing = -1

[State 0, ChangeState]
type = ChangeState
trigger1 = root, life = 0
trigger2 = lose
value = 5120

[State 0, 2]
type = VelSet
trigger1 = Time = 0
y = 0

;---------------------------------------------------------------------------
;Karasu Move
[Statedef 40020]
type    = S
physics = S
sprpriority = 0

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = pos y > -6
trigger1 = timemod = 5,0
trigger1 = vel x > 0
anim = F300
ownpal = 1
ownpal = 1
ID = 60
pos = -13,-pos y+3
scale = 1,1
removetime = -2
sprpriority=1
postype = p1

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = pos y > -6
trigger1 = timemod = 5,0
trigger1 = vel x < 0
anim = F300
ownpal = 1
ID = 60
pos = 13,-pos y+3
facing = -1
scale = 1,1
removetime = -2
sprpriority=1
postype = p1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = timemod = 25,0
trigger1 = parent, stateno != 2000
value = S2,8
channel = 2

[State 0, PowerAdd]
type = PowerAdd
trigger1 = timemod = 5,0
value = -2

[State 20, 1]
type = VelSet
trigger1 = root, command = "holdz"
;trigger1 = (rootdist x > -60 && facing = 1 && Ailevel != 0) || (rootdist x < 60 && facing = -1 && Ailevel != 0)
trigger1 = root, var(50) = 0 
trigger2 = p2bodydist x > 40
;trigger2 = (rootdist x > -60 && facing = 1 && Ailevel != 0) || (rootdist x < 60 && facing = -1 && Ailevel != 0)
trigger2 = root, var(50) = 1 
x = 7*cond(root,var(50)=0,facing,1)

[State 20, 1]
type = VelSet
trigger1 = root, command = "holdx"
;trigger1 = (rootdist x < 60 && facing = 1 && Ailevel != 0) || (rootdist x > -60 && facing = -1 && Ailevel != 0)
trigger1 = root, var(50) = 0 
trigger2 = p2bodydist x < -40
;trigger2 = (rootdist x < 60 && facing = 1 && Ailevel != 0) || (rootdist x > -60 && facing = -1 && Ailevel != 0)
trigger2 = root, var(50) = 1
x = -7*cond(root,var(50)=0,facing,1)

[State 20, 1]
type = VelSet
trigger1 = (root, command != "holdb" || pos y < -600) && root, command != "holdy" && Ailevel = 0
trigger3 = (root, command != "holdb" || pos y < -200) && root, command != "holdy" && Ailevel != 0
trigger2 = (root, command != "holdy" || pos y >= -5) && root, command != "holdb"
y = 0

[State 20, 1]
type = VelSet
trigger1 = root, command != "holdb" || root, command != "holdy"
trigger1 = root, var(50) = 0
trigger2 = p2bodydist y = [-20,30]
trigger2 = root, var(50) = 1
y = 0

[State 20, 1]
type = VelSet
trigger1 = root, command = "holdb"
trigger1 = root, var(50) = 0 && pos y > -600 
trigger2 = p2bodydist y < -20
trigger2 = root, var(50) = 1 && pos y > -200
y = -7

[State 20, 1]
type = VelSet
trigger1 = root, command = "holdy"
trigger1 = root, var(50) = 0 
trigger2 = p2bodydist y > 20
trigger2 = root, var(50) = 1
triggerall = pos y < -5
y = 7

[State 20, 4]
type = ChangeAnim
triggerall = vel x > 0
trigger1 = Anim != 40010
value = 40010

[State 20, 4]
type = ChangeAnim
triggerall = vel x < 0
trigger1 = Anim != 40020
value = 40020

[State 20, 4]
type = ChangeAnim
triggerall = vel x = 0
trigger1 = Anim != 40000
value = 40000

[State 0, ChangeState]
type = ChangeState
trigger1 = vel x = 0
trigger1 = vel y = 0
trigger1 = root, var(50) = 0
trigger2 = root, var(50) = 1
trigger2 = p2bodydist x = [-50,50]
trigger2 = p2bodydist y = [-20,30]
trigger3 = parent, stateno = 2300
trigger4 = parent, ctrl =0  && parent, stateno != 2100 && parent, stateno != 6001 && parent, stateno != 6002 && parent, stateno != [120,155]
trigger4 = parent, stateno != [70500,70511]
value = 40000

;---------------------------------------------------------------------------
;Karasu No Power
[Statedef 40100]
type    = S
movetype = H
physics = S
anim = 40100
ctrl = 0
sprpriority = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S2,10

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
v = 0
value = 4

[State 0, Veladd]
type=Veladd
trigger1= 1
y= 0.4

[State 0, ChangeState]
type = ChangeState
trigger1 = pos Y >= (-5 + var(5))
value = 40105

;---------------------------------------------------------------------------
;Karasu No Power
[Statedef 40105]
type    = S
movetype = H
physics = S
anim = 40105
ctrl = 0
velset = 0,0
sprpriority = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S2,10

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = F7,1

[State 0, Explod]
type = Explod
ownpal = 1
postype = p1
trigger1 = time = 0
anim = F60
ID = 60
pos = 0,3
scale = 1.7,1.7
removetime = -2

[State 0, AngleDraw]
type = Angleset
trigger1 = 1
value = 0

[State 0, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2
stateno = 40105

[State 0, PosSet]
type = PosSet
trigger1 = prevstateno = 40910
trigger2 = prevstateno = 40260
y = 0

[State 0, PosAdd]
type = PosAdd
triggerall = time = 0
trigger1 = var(10) > 999
trigger2 = root, life = 0
y = 5

[State 0, NotHitBy]
type = NotHitBy
trigger1 = var(10) > 999
trigger2 = root, life = 0
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 4

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
v = 0
value = 4

[State 0, ChangeState]
type = ChangeState
triggerall = animtime = 0
trigger2 = root, life = 0
trigger1 = var(10) > 999
trigger3 = lose
value = 40106

[State 0, ChangeState]
type = ChangeState
trigger1 = power != 0
trigger1 = var(10) < 1000
triggerall = root, life != 0
triggerall = !lose
value = 5120

;---------------------------------------------------------------------------
;Karasu Destroy
[Statedef 40106]
type    = S
movetype = H
physics = S
anim = 40106
ctrl = 0
velset = 0,0
sprpriority = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = power != 0
trigger1 = var(10) < 1000
trigger1 = root, life != 0
trigger1 = !lose
value = 5120

[State 0, NotHitBy]
type = NotHitBy
trigger1 = time >= 0
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 4

[State 0, dead]
type = destroyself
trigger1 = time >= 10
trigger1 = var(10) >= 1000
trigger2 = root, life = 0
trigger3 = lose

;---------------------------------------------------------------------------
;Karasu Ending
[Statedef 40180]
type    = S
movetype = H
physics = S
ctrl = 0
sprpriority = 0
anim = 40600

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 1
value = S2,8

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4
value = S2,10

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = ishelper(180)
trigger1 = time = 0
value = 40600
elem = 3

[State 0, Turn]
type = Turn
triggerall = animelem = 3
trigger1 = facing != parent, facing

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
x = -5

[State 0, PosSet]
type = PosSet
trigger1 = animelem = 3
x = parent, pos x + 45*facing
y = parent, pos y - 55

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 4
x = -5

[State 200, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 40181

;---------------------------------------------------------------------------
;Karasu Ending
[Statedef 40181]
type    = S
movetype = H
physics = S
anim = 40000
ctrl = 0
sprpriority = 3

[State 0, BindToParent]
type = BindToParent
trigger1 = 1
time = 1
pos =  7,-55

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3
trigger2 = animelem = 6
trigger3 = animelem = 9
trigger4 = animelem = 11
trigger5 = animelem = 13
trigger6 = animelem = 15
trigger7 = animelem = 17
triggerall = anim = 40180
triggerall = time < 99
value = S2,13

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time%5 = 0
triggerall = time > 99
value = S2,13

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = time = 30
value = 40180

[State 0, VelSet]
type = VelSet
trigger1 = 0;animelem = 4
x = -5
;---------------------------------------------------------------------------
; Karasu combo 1.1
[Statedef 40200]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 40200                       ;Change animation (Def: no change)
poweradd = -20
velset = 4,0                   ;Power to add (Def: 0)
sprpriority = 2                  ;Set p1's sprite layering priority to 2 (in front)

[State 0, Turn]
type = Turn
trigger1 = pos x > enemy(cond((enemy(0),alive),0,1)), pos x && facing = 1
trigger2 = pos x < enemy(cond((enemy(0),alive),0,1)), pos x && facing = -1
triggerall = time = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 6
trigger2 = AnimElem = 3
value = S2,9

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 1
value = S2,8

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 6
trigger2 = AnimElem = 3
value = S2,10

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = movehit = 1 && p2movetype = H
anim = F10+random%2
angle = -25+random%50
pos = -10,-30
postype = p2  ;p2,front,back,left,right
facing = 1
bindtime = 1
removetime = -2
sprpriority = 3
scale = 0.75,0.75
ownpal = 1
ontop = 0
supermovetime = 9999
pausemovetime = 9999

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = AnimElem = 3
anim = F1020
ID = 1020
pos = 20,-30
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
supermovetime= 9999
scale = 1.5,1.5
sprpriority = 3

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = AnimElem = 6
anim = F1030
ID = 1030
pos = 20,-30
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
supermovetime= 9999
scale = 1.5,1.5
sprpriority = 3

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
value = F8,0+random%5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
value = F24,0+random%5

[State 200, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = AnimElem = 6
trigger2 = AnimElem = 3
attr = S, NA                     ;Attribute: Standing, Normal Attack
getpower = 0,0
givepower = 0,0
damage = 15,3                ;Damage that move inflicts, guard damage
animtype = Light                 ;Animation type: Light, Medium, Heavy, Back (def: Light)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 3, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default                                 ;Hit/Miss/Dodge type (Def: Hit)
pausetime = 0,5                ;Time attacker pauses, time opponent shakes
sparkno = 0+random%4  
sparkxy = -15,-36
hitsound = 24, 2 
guardsound = 21, 7                ;Sound to play on guard
ground.type = High               ;Type: High, Low, Trip (def: Normal)
ground.slidetime = 5            ;Time that the opponent slides back
ground.hittime  = 12            ;Time opponent is in hit state
ground.velocity = -3             ;Velocity at which opponent is pushed
airguard.velocity = -2,-.8     ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
air.velocity = -1.4,-1           ;X-velocity at which opponent is pushed,
                               ;Y-velocity at which opponent is pushed
air.hittime = 12
envshake.time = 10
envshake.freq = 20
envshake.ampl = -5
envshake.phase = 10                 ;Time before opponent regains control in air

[State 0, TargetState]
type = TargetState
trigger1 = enemy(cond((enemy(0),alive),0,1)), var(30) = 0
value = 106000

[State 200, 2]
type = ChangeState
trigger1 = AnimTime = 0
trigger1 = parent, stateno = 1210
trigger1 = parent, facing != facing
triggerall = movecontact
value = 40210

[State 200, 2]
type = ChangeState
trigger1 = AnimTime = 0
trigger1 = parent, stateno = 1210
trigger1 = parent, facing = facing
triggerall = movecontact
value = 40211

[State 200, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 40000

;---------------------------------------------------------------------------
; Karasu combo 1.2
[Statedef 40210]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 40210                       ;Change animation (Def: no change)
poweradd = -20
velset = 4,0                   ;Power to add (Def: 0)
sprpriority = 2                  ;Set p1's sprite layering priority to 2 (in front)


[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = time = [6,20]
trigger1 = timemod = 5,0
anim = F1391
ownpal = 1
pos = 0,-30
scale = 0.5,0.5
removetime = -2
sprpriority=4
postype = p1
ownpal = 1
angle = 260+atan(vel y/vel x)*180/PI

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = movehit = 1 && p2movetype = H
anim = F10+random%2
angle = -25+random%50
pos = -10,-30
postype = p2  ;p2,front,back,left,right
facing = 1
bindtime = 1
removetime = -2
sprpriority = 3
scale = 0.75,0.75
ownpal = 1
ontop = 0
supermovetime = 9999
pausemovetime = 9999

[State 210, 2]
type = AfterImage
trigger1 = (!time)
time = 15
length = 15
palbright = 0,0,0
palcontrast = 160,150,150
palpostbright = 0,0,0
paladd = 5,0,0
palmul = 1,1,1
trans = add1

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
v = 3
value = Abs(parent, pos x - enemynear(cond((enemynear(0),alive),0,1)), pos x)/35

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
trigger1 = var(3) > 10
v = 3
value = 12

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 4
trigger2 = AnimElem = 6
value = S2,12

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 1
value = S2,8

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 2
trigger2 = AnimElem = 8
value = S2,10

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
value = F8,0+random%5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
value = F24,0+random%5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time < 20 && timemod = 10,0
trigger1 = time > 6
value = S2,13

[State 200, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = AnimElem = 3
trigger2 = AnimElem = 4
trigger3 = AnimElem = 5
attr = S, NA                     ;Attribute: Standing, Normal Attack
getpower = 0,0
givepower = 0,0
damage = 10,2                ;Damage that move inflicts, guard damage
animtype = Light                 ;Animation type: Light, Medium, Heavy, Back (def: Light)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 3, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default                                 ;Hit/Miss/Dodge type (Def: Hit)
pausetime = 0,5                ;Time attacker pauses, time opponent shakes
sparkno = 0+random%4  
sparkxy = -15,-35 
hitsound = 24, 2 
guardsound = 21, 7                ;Sound to play on guard
ground.type = High               ;Type: High, Low, Trip (def: Normal)
ground.slidetime = 5             ;Time that the opponent slides back
ground.hittime  = 12             ;Time opponent is in hit state
ground.velocity = -0.1             ;Velocity at which opponent is pushed
airguard.velocity = -0.1,-.7     ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
air.velocity = -0.1,-0.9           ;X-velocity at which opponent is pushed,
                                 ;Y-velocity at which opponent is pushed
air.hittime = 12  
envshake.time = 10
envshake.freq = 20
envshake.ampl = -5
envshake.phase = 10               ;Time before opponent regains control in air

[State 0, TargetState]
type = TargetState
trigger1 = enemy(cond((enemy(0),alive),0,1)), var(30) = 0
value = 106000

[State 200, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = AnimElem = 6
triggerall = parent, var(11) != 2100
attr = S, NA                     ;Attribute: Standing, Normal Attack
getpower = 0,0
givepower = 0,0
damage = 10,2               ;Damage that move inflicts, guard damage
animtype = Light                 ;Animation type: Light, Medium, Heavy, Back (def: Light)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 3, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default                                 ;Hit/Miss/Dodge type (Def: Hit)
pausetime = 0,5                 ;Time attacker pauses, time opponent shakes
sparkno = 0+random%4  
sparkxy = -15,-30 
hitsound = 24, 2 
guardsound = 21, 7               ;Sound to play on guard
ground.type = High               ;Type: High, Low, Trip (def: Normal)
ground.slidetime = 5             ;Time that the opponent slides back
ground.hittime  = 12           ;Time opponent is in hit state
ground.velocity = -var(3),-8             ;Velocity at which opponent is pushed
airguard.velocity = -0.1,-1     ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
air.velocity = -var(3),-8           ;X-velocity at which opponent is pushed,
                                 ;Y-velocity at which opponent is pushed
air.hittime = 12
fall = 1
fall.recover = 0
envshake.time = 10
envshake.freq = 20
envshake.ampl = -5
envshake.phase = 10

[State 200, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = AnimElem = 6
triggerall = parent, var(11) = 2100
attr = S, NA                     ;Attribute: Standing, Normal Attack
getpower = 0,0
givepower = 0,0
damage = 10,2                 ;Damage that move inflicts, guard damage
animtype = Light                 ;Animation type: Light, Medium, Heavy, Back (def: Light)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 3, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default                                 ;Hit/Miss/Dodge type (Def: Hit)
pausetime = 0,5                 ;Time attacker pauses, time opponent shakes
sparkno = 0+random%4  
sparkxy = -15,-30 
hitsound = 24, 2 
guardsound = 21, 7                ;Sound to play on guard
ground.type = High               ;Type: High, Low, Trip (def: Normal)
ground.slidetime = 5             ;Time that the opponent slides back
ground.hittime  = 12           ;Time opponent is in hit state
ground.velocity = -var(3),-4             ;Velocity at which opponent is pushed
airguard.velocity = -0.1,-1     ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
air.velocity = -var(3),-4           ;X-velocity at which opponent is pushed,
                                 ;Y-velocity at which opponent is pushed
air.hittime = 12
fall = 1
fall.recover = 0
envshake.time = 20
envshake.freq = 25
envshake.ampl = -6
envshake.phase = 10

[State 200, 2]
type = ChangeState
;trigger1 = time > 24
trigger1 = parent, stateno = 1230
value = 40220

[State 200, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 40000

;---------------------------------------------------------------------------
; Karasu combo 1.2a
[Statedef 40211]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 40211                       ;Change animation (Def: no change)
poweradd = -20
velset = 5,0                   ;Power to add (Def: 0)
sprpriority = 2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 1
trigger2 = AnimElem = 5
value = S2,10

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = time = [3,12]
flag = noshadow

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State 0, PosAdd]
type = PosAdd
trigger1 = time = 8
x = 60

[State 0, Turn]
type = Turn
trigger1 = AnimTime = 0

[State 200, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 40210

;---------------------------------------------------------------------------
; Karasu combo 1.4
[Statedef 40220]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 40220                       ;Change animation (Def: no change)
poweradd = -20
velset = 0,0                   ;Power to add (Def: 0)
sprpriority = 2

[State 210, 2]
type = AfterImage
trigger1 = (!time)
time = 25
length = 15
palbright = 0,0,0
palcontrast = 160,150,150
palpostbright = 0,0,0
paladd = 5,0,0
palmul = 1,1,1
trans = add1

[State 0, Helper]
type = Helper
trigger1 = time = 0
helpertype = normal
name = "clone"
ID = 40221
stateno = 40221
pos = 0,0
postype = p1
facing = 1
keyctrl = 0

[State 0, PosAdd]
type = PosAdd
trigger1 = animelem = 4
y = -30

[State 1640, X]
Type=VarSet
Trigger1= helper(40221) , movecontact = 0
fvar(13)=(enemynear(cond((enemynear(0),alive),0,1)),Pos X-Pos X)*Facing

[State 1640, Y]
Type=VarSet
trigger1= helper(40221), movecontact = 0
fvar(14)=(enemynear(cond((enemynear(0),alive),0,1)),pos Y-Pos Y)

[State 1640, Vector Length]
Type=VarSet
trigger1= helper(40221), movecontact = 0
fvar(15)=Exp(0.5*ln((fvar(13)*fvar(13))+(fvar(14)*fvar(14))))

[State 0, VelSet]
type=VelSet
trigger1= time > 12 && helper(40221), movecontact = 0
x=(Fvar(13))/(fvar(15))*16
y=(FVar(14))/(fvar(15))*16

[State 0, AngleDraw]
type = Angleset
trigger1 = helper(40221), movecontact = 0
value = (atan(Vel Y/Vel X)+(4*Pi/2))*(-180/Pi) + 45

[State 0, AngleDraw]
type = Angledraw
trigger1 = 1

[State 0, VelSet]
type=VelSet
trigger1= helper(40221), movecontact
x= 0
y= 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 1
value = S2,8

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 4
trigger2 = AnimElem = 6
value = S2,10

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 5
trigger2 = AnimElem = 4
trigger3 = AnimElem = 6
value = S2,11


[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 1
value = F24,0+random%5

[State 200, 2]
type = ChangeState
trigger1 = numhelper(40221) = 0
value = 40222

;---------------------------------------------------------------------------
; Clone
[Statedef 40221]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 40221                       ;Change animation (Def: no change)
poweradd = -20
velset = 0,0                   ;Power to add (Def: 0)
sprpriority = 1

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = movehit = 1 && p2movetype = H
anim = F10+random%2
angle = -25+random%50
pos = 10-random%20,-5-random%20
postype = p2  ;p2,front,back,left,right
facing = 1
bindtime = 1
removetime = -2
sprpriority = 3
scale = 0.75,0.75
ownpal = 1
ontop = 0
supermovetime = 9999
pausemovetime = 9999

[State 200, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = timemod = 3,0 && time < 45
attr = S, NA                     ;Attribute: Standing, Normal Attack
getpower = 0,0
givepower = 0,0
damage = 5,1                 ;Damage that move inflicts, guard damage
animtype = Light                 ;Animation type: Light, Medium, Heavy, Back (def: Light)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 3, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default                                 ;Hit/Miss/Dodge type (Def: Hit)
pausetime = 0,5                 ;Time attacker pauses, time opponent shakes
sparkno = 0+random%4  
sparkxy = -15,-10-random%15 
hitsound = 24, 2 
guardsound = 21, 7               ;Sound to play on guard
ground.type = High               ;Type: High, Low, Trip (def: Normal)
ground.slidetime = 5             ;Time that the opponent slides back
ground.hittime  = 12          ;Time opponent is in hit state
ground.velocity = 0.5,-0.7             ;Velocity at which opponent is pushed
airguard.velocity = -0.5,-1     ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
air.velocity = 0.5,-0.7            ;X-velocity at which opponent is pushed,
                                 ;Y-velocity at which opponent is pushed
air.hittime = 12
fall = 1
fall.recover = 0
envshake.time = 10
envshake.freq = 20
envshake.ampl = -5
envshake.phase = 10

[State 0, TargetState]
type = TargetState
trigger1 = enemy(cond((enemy(0),alive),0,1)), var(30) = 0
value = 106000

[State 200, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = time = [45,46]
attr = S, NA                     ;Attribute: Standing, Normal Attack
getpower = 0,0
givepower = 0,0
damage = 10,2               ;Damage that move inflicts, guard damage
animtype = Light                 ;Animation type: Light, Medium, Heavy, Back (def: Light)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 3, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default                                 ;Hit/Miss/Dodge type (Def: Hit)
pausetime = 0,5                ;Time attacker pauses, time opponent shakes
sparkno = 0+random%4  
sparkxy = -15,0
hitsound = 24, 2 
guardsound = 21, 7                ;Sound to play on guard
ground.type = High               ;Type: High, Low, Trip (def: Normal)
ground.slidetime = 5             ;Time that the opponent slides back
ground.hittime  = 12          ;Time opponent is in hit state
ground.velocity = 5,-4             ;Velocity at which opponent is pushed
airguard.velocity = 5,-1     ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
air.velocity = 5,-4            ;X-velocity at which opponent is pushed,
                                 ;Y-velocity at which opponent is pushed
air.hittime = 12
fall = 1
fall.recover = 0
envshake.time = 30
envshake.freq = 30
envshake.ampl = -7
envshake.phase = 10

[State 0, BindToParent]
type = BindToParent
trigger1 = 1
time = 3
pos = 0,0

[State 200, 2]
type = destroyself
trigger1 = parent, stateno != 40220
trigger2 = time = 50
;---------------------------------------------------------------------------
; Karasu combo 1.4 end
[Statedef 40222]
type = S
physics = S
movetype= I
juggle  = 4
ctrl = 0
velset = 0,0
anim = 40222

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 1
value = S2,8

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 1
value = S2,10

[State 0, PosAdd]
type = PosAdd
trigger1 = time = 0
y = 30

[State 0, ChangeState]
type = ChangeState
trigger1 = animtime = 0
value = 40000

;---------------------------------------------------------------------------
; Karasu combo 2.2
[Statedef 40250]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 40240                       ;Change animation (Def: no change)
poweradd = -20
velset = 7,-8                  ;Power to add (Def: 0)
sprpriority = 2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 6
trigger2 = AnimElem = 3
value = S2,9

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 1
value = S2,8

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 2
trigger2 = AnimElem = 4
value = S2,10

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
value = F8,0+random%5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3
value = F24,0+random%5                  ;Set p1's sprite layering priority to 2 (in front)

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = timemod = 4,0
anim = F280
ID = 280
pos = -15,15
postype = p1  ;p2,front,back,left,right
facing = 1
removetime = -2
scale = 1.5,1.5
sprpriority = 2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 3
value = S2,12

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = movehit = 1 && p2movetype = H
anim = F11+random%2
angle = -25+random%50
pos = 0,-40
postype = p2  ;p2,front,back,left,right
facing = 1
bindtime = 1
removetime = -2
sprpriority = 3
scale = 0.75,0.75
ownpal = 1
ontop = 0
supermovetime = 9999
pausemovetime = 9999

[State 200, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = 1
attr = S, NA                     ;Attribute: Standing, Normal Attack
getpower = 0,0
givepower = 0,0
damage = 5,1                 ;Damage that move inflicts, guard damage
animtype = Light                 ;Animation type: Light, Medium, Heavy, Back (def: Light)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 3, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default                                 ;Hit/Miss/Dodge type (Def: Hit)
pausetime = 0,5                 ;Time attacker pauses, time opponent shakes
sparkno = 0+random%4  
sparkxy = -15,-40 
hitsound = 24, 2 
guardsound = 21, 7               ;Sound to play on guard
ground.type = High               ;Type: High, Low, Trip (def: Normal)
ground.slidetime = 5             ;Time that the opponent slides back
ground.hittime  = 12            ;Time opponent is in hit state
ground.velocity = -0.1             ;Velocity at which opponent is pushed
airguard.velocity = -0.1,-2     ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
air.velocity = -0.1,-2
fall = 1
fall.recover = 12       ;X-velocity at which opponent is pushed,
                                 ;Y-velocity at which opponent is pushed
air.hittime = 0  
envshake.time = 10
envshake.freq = 20
envshake.ampl = -5
envshake.phase = 10               ;Time before opponent regains control in air

[State 0, TargetState]
type = TargetState
trigger1 = enemy(cond((enemy(0),alive),0,1)), var(30) = 0
value = 106000

[State 200, 2]
type = ChangeState
trigger1 = AnimTime = 0
;trigger1 = parent, stateno = 1260
triggerall = movecontact
value = 40260

[State 200, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 40000

;------------------------------------------------------------------
;Karasu combo 2.3
[StateDef 40260]
type = S
movetype= A
physics = N
juggle  = 3
velset = 0,15
ctrl = 0
sprpriority = 3
anim = 40910

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = timemod = 5,0
anim = F1391
ownpal = 1
pos = 0,10
scale = 0.4,0.4
removetime = -2
sprpriority=4
postype = p1
ownpal = 1
angle = 260+atan(vel y/vel x)*180/PI

[State 0, PlaySnd]
type = PlaySnd
trigger1 = movehit
persistent = 0
value = F15,2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = movehit
persistent = 0
value = F15,4

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = time%8 = 0
trigger1 = !movehit
anim = 40915
ID = 40915
pos = 0,150
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
removetime = -2
scale = 0.9,0.9
sprpriority = 4

[State 210, 2]
type = AfterImage
trigger1 = time = 0
time = 35
length = 20
palbright = 0,0,0
palcontrast = 160,150,150
palpostbright = 0,0,0
paladd = 5,0,0
palmul = 1,1,1
trans = add1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 180

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = movehit = 1 && p2movetype = H
anim = F10+random%2
angle = -25+random%50
pos = 10-random%20,-10-random%40
postype = p2  ;p2,front,back,left,right
facing = 1
bindtime = 1
removetime = -2
sprpriority = 3
scale = 0.75,0.75
ownpal = 1
ontop = 0
supermovetime = 9999
pausemovetime = 9999

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 1
value = S2,9

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 1
value = S2,8

[State 0, PlaySnd]
type = PlaySnd
trigger1 = AnimElem = 3
value = S2,10

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
value = F8,0+random%5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 1
value = F24,0+random%5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = timemod = 10,0
value = S2,13

[State 200, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = time%6 = 0
attr = S, NA                     ;Attribute: Standing, Normal Attack
getpower = 0,0
givepower = 0,0
damage = 15,3             ;Damage that move inflicts, guard damage
animtype = Light                 ;Animation type: Light, Medium, Heavy, Back (def: Light)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 3, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default                                 ;Hit/Miss/Dodge type (Def: Hit)
pausetime = 0,0                ;Time attacker pauses, time opponent shakes
sparkno = 0+random%4  
sparkxy = -15,-30 
hitsound = 24, 2 
guardsound = 21, 7               ;Sound to play on guard
ground.type = High               ;Type: High, Low, Trip (def: Normal)
ground.slidetime = 5             ;Time that the opponent slides back
ground.hittime  = 12           ;Time opponent is in hit state
ground.velocity = -4,9           ;Velocity at which opponent is pushed
airguard.velocity = -4,9     ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
air.velocity = -4,9            ;X-velocity at which opponent is pushed,
fall.damage = 50                                 ;Y-velocity at which opponent is pushed
air.hittime = 12
fall = 1
fall.recover = 0
envshake.time = 30
envshake.freq = 30
envshake.ampl = -7
envshake.phase = 10

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = pos y > -60
anim = F210
ID = 40900
pos = 20,0
postype = p1  ;p2,front,back,left,right
sprpriority = 4
scale = 1.5,1.5
facing = 1
removetime = -2

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = pos y > -60
anim = F61
ID = 40900
pos = 20,0
postype = p1  ;p2,front,back,left,right
sprpriority = 3
scale = 1.4,1.4
facing = 1
removetime = -2

[State 1210, end]
type = changeState
trigger1 = pos y > -60
value = 40105

;---------------------------------------------------------------------------
;Karasu (Toxic combo)
[Statedef 40300]
type    = S
physics = S
ctrl = 0
sprpriority = 1

[State 0, SuperPause]
type = SuperPause
trigger1 = time = 0
time = 300
movetime = 300
anim = -1
sound = 0,-1
darken = 0
unhittable = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = timemod = 25,0
value = S2,8
channel = 2

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 0;1
flag = nobardisplay

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

;[State 0, Turn]
;type = Turn
;trigger1 = facing != helper(60000), facing

[State 20, 1]
type = VelSet
trigger1 = parent, var(2) > pos x
trigger1 = facing = 1
trigger2 = parent, var(2) < pos x
trigger2 = facing = -1
;triggerall = (Abs(parent, var(2))-Abs(pos x)) != [-135,35]
x = 6

[State 0, PlayerPush]
type = PlayerPush
trigger1 = vel x !=0
trigger2 = vel y !=0
value = 0

[State 20, 2]
type = VelSet
trigger1 = parent, var(2) < pos x
trigger1 = facing = 1
trigger2 = parent, var(2) > pos x
trigger2 = facing = -1
;triggerall = (Abs(parent, var(2))-Abs(pos x)) != [-35,35]
x = -6

[State 20, 1]
type = VelSet
trigger1 = pos y < -55
triggerall = pos y != [-55,-45]
y = 6

[State 20, 1]
type = VelSet
trigger1 = pos y = [-55,-45]
y = 0

[State 20, 1]
type = VelSet
trigger1 = pos y > -45
triggerall = pos y != [-55,-45]
y = -6

[State 20, 4]
type = ChangeAnim
triggerall = vel x > 0
trigger1 = Anim != 40011
value = 40011

[State 20, 4]
type = ChangeAnim
triggerall = vel x < 0
trigger1 = Anim != 40021
value = 40021

[State 20, 4]
type = ChangeAnim
triggerall = vel x = 0
trigger1 = Anim != 40000
value = 40000

[State 0, ChangeState]
type = ChangeState
trigger1 =  (Abs(parent, var(2))-Abs(pos x)) = [-15,15]
trigger1 = pos y = [-55,-45]
value = 40310
ctrl = 0

;---------------------------------------------------------------------------
;Karasu toxic combo
[Statedef 40310]
movetype= A
physics = N
juggle  = 4
velset = 0,0
ctrl = 0
poweradd = -500
anim = 40310

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 1
value = S2,8

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 6
value = S2,10

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 0;1
flag = nobardisplay

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State 0, Turn]
type = Turn
trigger1 = pos x > helper(60000), pos x && facing = 1
trigger2 = pos x < helper(60000), pos x && facing = -1

[State 0, Helper]
type = Helper
trigger1 = animelem = 7
helpertype = normal
name = "toxic bomb"
pos = 10,-41
ID = 40310
stateno = 40311
facing = 1
supermovetime = 9999

[State 0, Helper]
type = Helper
trigger1 = animelem = 10
helpertype = normal
name = "toxic bomb"
pos = 10,-41
ID = 40310
stateno = 40311
facing = 1
supermovetime = 9999

[State 0, ChangeState]
type = ChangeState
trigger1 = numhelper(40310) = 10
value = 40320
ctrl = 0

;------------------------------------------------------------------
;toxic bomb
[Statedef 40311]
type = S
movetype= A
physics = N
juggle  = 3
velset = 0,0
anim = 40531
sprpriority = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, VelSet]
type=VelSet
trigger1= time = 0
x= 7+random%4

[State 0, VelSet]
type=Veladd
trigger1= 1
y = 0.25

[State 0, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA,NA,SA,HA,NP,SP,HP,ST,HT,NT;SCA, NA, SA, HA, NP, SP, HP
stateno = 40312
time = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = frontedgebodydist < -50
ignorehitpause = 1

[State 1003, ChangeState]
type = changestate
trigger1 =  pos Y >= -5 + parent, var(5)
value = 40312

;---------------------------------------------------------------------------
;toxic Gas
[Statedef 40312]
movetype= A
physics = N
juggle  = 4
velset = 0,0
ctrl = 0
anim = 40532
sprpriority = 19

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = F9,2

[State 0, PosSet]
type = PosSet
trigger1 = time = 0
y = 10 + parent, var(5)

[State 0, Trans]
type = Trans
trigger1 = time < 285
trans = addalpha
alpha = 256,256

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time < 15
scale = time*0.016, time*0.016 ;time*(0.285-(time*0.00685)),time*(0.285-(time*0.00685))

[State 0, AngleDraw]
type = AngleDraw
trigger1 = time >= 15
scale = 0.25+time*0.0001,0.25+time*0.0001

[State 200, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = time%10 = 0
attr =  C,HP
damage = 5, 1
getpower = 0,0
givepower = 0,0
animtype = Light
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 0, 3
sparkno = -1
sparkxy = -18, -16
hitsound = 0, 3
guardsound = 6, 0
ground.type = High
ground.slidetime = 5
ground.hittime  = 12
ground.velocity = 0
airguard.velocity = 0,5
air.type = High
air.velocity = 0,5
air.hittime = 12
p2stateno = 106001
palfx.time = 30
palfx.mul = 120,20,160
palfx.add = 100,0,50

[State 0, Trans]
type = Trans
trigger1 = time >= 280
trans = addalpha
alpha = 256-(time-280)*6,256

[State 0, end]
type = destroyself
trigger1 = helper(40330), stateno = 40335
trigger1 = helper(40330), time > 5

;---------------------------------------------------------------------------
;Karasu toxic combo
[Statedef 40320]
movetype= A
physics = N
juggle  = 4
velset = 0,0
ctrl = 0
poweradd = -1000
anim = 40320

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 1
value = S2,8

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 5
value = S2,10

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 0;1
flag = nobardisplay

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State 0, SuperPause]
type = SuperPause
trigger1 = animelem = 5
time = 30
anim = 101
pos = 5,-45
sound = F19,0
darken = 0
unhittable = 0

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = animelem = 6
anim = 40815
ID = 40815
pos = 4,-44
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
removetime = -2
scale = 0.5,0.5
sprpriority = 3
supermovetime = 9999

[State 0, Helper]
type = Helper
trigger1 = animelem = 6
helpertype = normal
name = "BOMB"
pos = 1,-45
ID = 40330
stateno = 40330
facing = 1
supermovetime = 9999

[State 0, ChangeState]
type = ChangeState
trigger1 = animtime = 0
value = 40000
ctrl = 0

;------------------------------------------------------------------
;BOMB
[Statedef 40330]
type = S
movetype= A
physics = N
juggle  = 3
velset = 0,0
anim = 41000
sprpriority = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 0;1
flag = nobardisplay

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, VelSet]
type=VelSet
trigger1= 1
x= 6

[State 0, VelSet]
type=Veladd
trigger1= 1
y = 0.2

[State 1004, ChangeState]
type = changestate
trigger1 = pos y > -1
value = 40335
;---------------------------------------------------------------------------
;BOOM
[Statedef 40335]
type    = S
movetype= A
physics = S
juggle  = 4
poweradd= 0
velset = 0,0
sprpriority = 10
ctrl = 0
anim = 60320

[State 0, TargetState]
type = TargetState
trigger1 = enemy(cond((enemy(0),alive),0,1)), var(51) = 0
trigger1 = !(enemynear, ishelper)
trigger1 = target, ishelper = 0
trigger1 = movehit
value = 109912

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = F10,1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = F10,2

[State 0, EnvShake]
type = EnvShake
trigger1 = time = 0
time = 80
ampl = -8
freq = 80
phase = 230

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = time = 0 && pos y >= -40
anim = F820;580
pos = 0,-pos y+5
angle = 90
scale = 1.5,3
postype = p1
facing = 1
bindtime = 1
removetime = -2
sprpriority = 4
supermove = 9999
pausemove = 9999
supermovetime = 9999
pausemovetime = 9999
ownpal = 1

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = time = 0
anim = F1190
pos = 0,3
postype = p1
facing = 1
bindtime = 1
removetime = -2
sprpriority = 15
scale = 2,2
ownpal = 1
ontop = 0
supermovetime = 9999
pausemovetime = 9999

[State 0, EnvShake]
type = EnvShake
trigger1 = time = 0
time = 50
freq = 60
ampl = -4
phase = 70

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 0;1
flag = nobardisplay

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
scale = 0.55,0.55

[State 0, Trans]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = F15,0

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0

[State 0, PosAdd]
type = PosAdd
trigger1 = time = 0
x = 30

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = time = 0
trigger1 = prevstateno = 70735
trigger1 = target, ishelper = 0
flag = unguardable

[State 1011, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = timemod = 10,1
attr = S, NA
damage = 150,60
animtype = Light
getpower = 0,0
givepower = 0,0
guardflag = MA
hitflag = MAF
priority = 10, Hit
pausetime = 0, 0
sparkno = 1400
hitsound = -1, 3
guardsound = -1, 0
ground.type = High
ground.slidetime = 5
ground.hittime  = 100
ground.velocity = -0.3,-10
airguard.velocity = -0.3,-10
air.type = High
air.velocity =  -0.3,-10
air.hittime = 100
p2sprpriority = 0
p1sprpriority = 10
fall = 1
fall.recover = 0
palfx.time = 30
palfx.add = 240,50,0
palfx.mul = 250,224,120
palfx.sinadd = 110,55,85,10

[State 1011, Destroyself]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
;Karasu Senbon
[Statedef 40500]
movetype= A
physics = N
juggle  = 4
velset = 0,0
ctrl = 0
poweradd = -250
anim = 40500

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time > 16 && time < 54
trigger1 = timemod = 10,1
value = S2,7

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S2,8

[State 0, Helper]
type = Helper
trigger1 = timemod = 10,1
trigger1 = time > 16 && time < 54
helpertype = normal
name = "senbon"
pos = -1,-31
ID = 40501
stateno = 40501
facing = 1

[State 0, Helper]
type = Helper
trigger1 = timemod = 15,1
trigger1 = time > 16 && time < 54
helpertype = normal
name = "senbon"
pos = 15,-14
ID = 40501
stateno = 40501
facing = 1

[State 0, Helper]
type = Helper
trigger1 = timemod = 15,1
trigger1 = time > 16 && time < 54
helpertype = normal
name = "senbonunguard"
pos = -1,-31
ID = 40501
stateno = 40502
facing = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = animtime = 0
value = 40000
ctrl = 0

;---------------------------------------------------------------------------
;Senbon 1st Hand
[Statedef 40501]
movetype= A
physics = N
juggle  = 5
ctrl = 0
anim = 40505
sprpriority = 3

[State 450, VelSet]
type = VelSet
trigger1 = time = 0
x= cos(PI/8)*18
y= sin(PI/8)*14-(random%20)*0.1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 25
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 450, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = time = 0
attr = S, NA
damage = 15, 3
getpower = 0,0
givepower = 0,0
animtype = Light
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 0, 1
sparkno = 1234
sparkxy = -10, 0
hitsound = 0,-1
guardsound = 6, 0
ground.type = High
ground.slidetime = 5
ground.hittime  = 15
ground.velocity = 0,0
airguard.velocity = -1.9,-.8
air.type = High
air.velocity = -1,5
air.hittime = 15
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = movehit
value = S2,5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = moveguarded
value = F21,2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = moveguarded
value = F21,1

[State 0, ChangeState]
type = ChangeState
trigger1 = movehit
value = 70720
ctrl = 0

[State 0, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA,NA,SA,HA,NP,SP,HP,ST,HT,NT;SCA, NA, SA, HA, NP, SP, HP
stateno = 40505
time = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = frontedgebodydist < -50
;trigger2 = movehit
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = moveguarded
value = 40505
ctrl = 0

[State 1004, ChangeState]
type = changestate
trigger1 = pos y > -1
value = 40506

;---------------------------------------------------------------------------
;Senbon Ungardable
[Statedef 40502]
movetype= A
physics = N
juggle  = 5
ctrl = 0
anim = 40505
sprpriority = 3

[State 450, VelSet]
type = VelSet
trigger1 = time = 0
x= cos(PI/8)*18
y= sin(PI/8)*14-(random%20)*0.1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 25
ignorehitpause = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = target, ishelper = 0
flag = unguardable

[State 450, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = time = 0
attr = S, NA
damage = 15, 3
getpower = 0,0
givepower = 0,0
animtype = Light
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 0, 1
sparkno = 1234
sparkxy = -10, 0
hitsound = 0,-1
guardsound = 6, 0
ground.type = High
ground.slidetime = 5
ground.hittime  = 15
ground.velocity = 0,0
airguard.velocity = -1.9,-.8
air.type = High
air.velocity = 0,0
air.hittime = 15
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = movehit
value = S2,5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = moveguarded
value = F21,2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = moveguarded
value = F21,1

[State 0, ChangeState]
type = ChangeState
trigger1 = movehit
value = 70720
ctrl = 0

[State 0, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA,NA,SA,HA,NP,SP,HP,ST,HT,NT;SCA, NA, SA, HA, NP, SP, HP
stateno = 40505
time = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = frontedgebodydist < -50
;trigger2 = movehit
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = moveguarded
value = 40505
ctrl = 0

[State 1004, ChangeState]
type = changestate
trigger1 = pos y > -1
value = 40506

;------------------------------------------------------------------
;Senbon odbicie
[Statedef 40505]
type    = S
movetype= A
physics = S
juggle  = 4
poweradd= 0
ctrl = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = p2stateno != [120,155]
trigger1 = time = 0
value = F21,0

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = p2stateno != [120,155]
trigger1 = time = 0
anim = F230
pos = 0,0
postype = p1
scale =  1,1
bindtime = 1

[State 6002, NotHitBy]
type = NotHitBy
trigger1 = !time
value = SCA
time = -1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -time*30

[State 0, Gravity]
type = Gravity
trigger1 = 1

[State 6002, VelSet]
type = VelSet
trigger1 = time = 0
y = -(random%30+20)/10

[State 6002, VelSet]
type = VelSet
trigger1 = 1
x = (random%40+20)/10

[State 0, Turn]
type = Turn
trigger1 = time = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = pos Y >= -5
value = 40506

;------------------------------------------------------------------
;Senbon wbicie
[StateDef 40506]
type = A
movetype= A
physics = N
juggle  = 3
velset = 0,0
ctrl = 0
sprpriority = 2
anim = 40506

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S2,1

[State 6002, NotHitBy]
type = NotHitBy
trigger1 = !time
value = SCA
time = -1

[State 1012, Trans]
type = Trans
trigger1 = time >= 35
trans = addalpha
alpha = 256-(time-35)*9.6,(time-35)*9.6

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time = 65

;---------------------------------------------------------------------------
;Karasu Kunai
[Statedef 40510]
movetype= A
physics = N
juggle  = 4
velset = 0,0
ctrl = 0
poweradd = -200
anim = 40510

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S2,8

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4
trigger3 = animelem = 5
trigger2 = animelem = 6
value = S1,3

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = animelem = 4
trigger3 = animelem = 5
trigger2 = animelem = 6
anim = 40815
ID = 40815
pos = 4,-44
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
random = 6,6
removetime = -2
scale = 0.5,0.5
sprpriority = 1

[State 0, Helper]
type = Helper
trigger1 = animelem = 4
helpertype = normal
name = "kunai"
pos = 1,-45
ID = 500
stateno = 70700
facing = 1

[State 0, Helper]
type = Helper
trigger1 = animelem = 5
helpertype = normal
name = "kunai"
pos = 1,-41
ID = 500
stateno = 70700
facing = 1

[State 0, Helper]
type = Helper
trigger1 = animelem = 6
helpertype = normal
name = "kunai"
pos = 1,-49
ID = 500
stateno = 70700
facing = 1


[State 0, ChangeState]
type = ChangeState
trigger1 = animtime = 0
value = 40000
ctrl = 0

;---------------------------------------------------------------------------
;Karasu Smoke bomb
[Statedef 40520]
movetype= A
physics = N
juggle  = 4
velset = 0,0
ctrl = 0
anim = 40520
poweradd = -100

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S2,8

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 6
value = S2,10

[State 0, Helper]
type = Helper
trigger1 = animelem = 7
helpertype = normal
name = "smoke bomb"
pos = 8,-41
ID = 630
stateno = 40521
facing = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = animtime = 0
value = 40000
ctrl = 0

;------------------------------------------------------------------
;Smoke Bomb
[Statedef 40521]
type = S
movetype= A
physics = N
juggle  = 3
velset = 0,0
anim = 40521 ;do podstawienia animacja smoke kunaia poziomo
sprpriority = 2

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, VelSet]
type=VelSet
trigger1= 1
x= 8

[State 0, VelSet]
type=Veladd
trigger1= 1
y = 0.2

[State 0, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = !time
attr = A, NP
damage = 1
animtype = Light
getpower = 0,0
givepower = 0,0
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 3, 15
sparkno = 29
sparkxy = -10, 0
hitsound = -1
guardsound = 6, 0
ground.type = High
ground.slidetime = 5
ground.hittime  = 12
ground.velocity = -2
airguard.velocity = -1.9,-.8
air.type = High
air.velocity = -2,-3
air.hittime = 12

[State 0, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA,NA,SA,HA,NP,SP,HP,ST,HT,NT;SCA, NA, SA, HA, NP, SP, HP
stateno = 70745
time = 9999

[State 0, DestroySelf]
type = DestroySelf
trigger1 = frontedgebodydist < -50
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = movecontact
value = 70745
ctrl = 0

[State 1004, ChangeState]
type = changestate
trigger1 = pos y > -1
value = 70745

;---------------------------------------------------------------------------
;Karasu toxic bomb
[Statedef 40530]
movetype= A
physics = N
juggle  = 4
velset = 0,0
ctrl = 0
poweradd = -200
anim = 40530

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S2,8

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 6
trigger2 = animelem = 9
value = S2,10

[State 0, Helper]
type = Helper
trigger1 = animelem = 7
helpertype = normal
name = "toxic bomb"
pos = 10,-41
ID = 40530
stateno = 40531
facing = 1

[State 0, Helper]
type = Helper
trigger1 = animelem = 10
helpertype = normal
name = "toxic bomb"
pos = 10,-41
ID = 40530
stateno = 40531
facing = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = animtime = 0
value = 40000
ctrl = 0

;------------------------------------------------------------------
;toxic bomb
[Statedef 40531]
type = S
movetype= A
physics = N
juggle  = 3
velset = 0,0
anim = 40531
sprpriority = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, VelSet]
type=VelSet
trigger1= time = 0
x= 10+(random%40)*0.1

[State 0, VelSet]
type=Veladd
trigger1= 1
y = 0.2

[State 200, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = 1
attr =  A, NP
damage = 1, 0
getpower = 0,0
givepower = 0,0
animtype = Light
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 0, 3
sparkno = -1
sparkxy = 0, -40
hitsound = 0, -1
guardsound = 6, -1
ground.type = High
ground.slidetime = 1
ground.hittime  = 1
ground.velocity = 0
airguard.velocity = 0,0
air.type = High
air.velocity = 0,0
air.hittime = 1

[State 0, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA,NA,SA,HA,NP,SP,HP,ST,HT,NT;SCA, NA, SA, HA, NP, SP, HP
stateno = 40532
time = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = frontedgebodydist < -50
ignorehitpause = 1

[State 1003, ChangeState]
type = changestate
trigger1 =  pos Y >= -5 + parent, var(5)
trigger2 = movecontact
value = 40532

;---------------------------------------------------------------------------
;toxic Gas
[Statedef 40532]
movetype= A
physics = N
juggle  = 4
velset = 0,0
ctrl = 0
anim = 40533
sprpriority = 19

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = F9,2

[State 0, Trans]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
scale = 0.8,0.8

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 200, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = time%3 = 0
trigger1 = enemynear, var(30) = 0
attr =  C,HP
damage = 50, 1
getpower = 0,0
givepower = 0,0
animtype = Light
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 0, 3
sparkno = -1
sparkxy = 0, -40
hitsound = 0, 3
guardsound = 6, 0
ground.type = High
ground.slidetime = 5
ground.hittime  = 30
ground.velocity = 0
airguard.velocity = 0,1
air.type = High
air.velocity = 0,1
air.hittime = 30
affectteam = B
palfx.time = 30
palfx.mul = 120,20,160
palfx.add = 100,0,50

[State 0, TargetState]
type = TargetState
trigger1 = enemynear, var(30) = 0
value = 106000

[State 0, end]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
;Karasu Explode Kunai
[Statedef 40540]
movetype= A
physics = N
juggle  = 4
velset = 0,0
ctrl = 0
anim = 40510
poweradd = -150
sprpriority = 2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S2,8

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 5
value = S1,3

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = animelem = 5
anim = 40815
ID = 40815
pos = 4,-44
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
removetime = -2
scale = 0.5,0.5
sprpriority = 3

[State 0, Helper]
type = Helper
trigger1 = animelem = 5
helpertype = normal
name = "kunai"
pos = 6,-45
ID = 500
stateno = 70730
ownpal = 1
facing = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = animtime = 0
value = 40000
ctrl = 0

;---------------------------------------------------------------------------
;Karasu Poison Knife
[Statedef 40550]
movetype= A
physics = N
juggle  = 4
velset = 0,0
ctrl = 0
anim = 40510
poweradd = -200
sprpriority = 2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S2,8

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 5
value = S1,3

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = animelem = 5
anim = 40815
ID = 40815
pos = 4,-44
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
removetime = -2
scale = 0.5,0.5
sprpriority = 3

[State 0, Helper]
type = Helper
trigger1 = animelem = 5
helpertype = normal
name = "knife"
pos = 5,-43
ID = 40550
stateno = 40551
facing = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = animtime = 0
value = 40000
ctrl = 0

;---------------------------------------------------------------------------
;Poison Knife
[Statedef 40551]
movetype= A
physics = N
juggle  = 5
ctrl = 0
anim = 40550
sprpriority = 3

[State 450, VelSet]
type = VelSet
trigger1 = 1
x = 18

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 450, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = time = 0
attr = S, NA
damage = 10, 2
getpower = 0,0
givepower = 0,0
animtype = Light
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 0, 1
sparkno = 29
sparkxy = -10, 0
hitsound = -1
guardsound = 6, 0
ground.type = High
ground.slidetime = 5
ground.hittime  = 15
ground.velocity = 0,0
airguard.velocity = -1.9,-.8
air.type = High
air.velocity = 0,0
air.hittime = 15
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
p2stateno = 106002

[State 0, PlaySnd]
type = PlaySnd
trigger1 = movehit
value = S2,5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = moveguarded
value = F21,2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = moveguarded
value = F21,1

[State 0, ChangeState]
type = ChangeState
trigger1 = movehit
value = 70720
ctrl = 0

[State 0, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA,NA,SA,HA,NP,SP,HP,ST,HT,NT;SCA, NA, SA, HA, NP, SP, HP
stateno = 40552
time = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = frontedgebodydist < -50
;trigger2 = movehit
ignorehitpause = 1

[State 0, ChangeState]
type = ChangeState
trigger1 = moveguarded
value = 40552
ctrl = 0

;------------------------------------------------------------------
;Poison Knife odbicie
[Statedef 40552]
type    = S
movetype= A
physics = S
juggle  = 4
poweradd= 0
ctrl = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = p2stateno != [120,155]
trigger1 = time = 0
value = F21,0

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = p2stateno != [120,155]
trigger1 = time = 0
anim = F230
pos = 0,0
postype = p1
scale =  1,1
sprpriority = 3
bindtime = 1

[State 6002, NotHitBy]
type = NotHitBy
trigger1 = !time
value = SCA
time = -1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -time*30

[State 0, Gravity]
type = Gravity
trigger1 = 1

[State 6002, VelSet]
type = VelSet
trigger1 = time = 0
y = -(random%30+20)/10

[State 6002, VelSet]
type = VelSet
trigger1 = 1
x = (random%40+20)/10

[State 0, Turn]
type = Turn
trigger1 = time = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = pos Y >= -5
value = 40553

;------------------------------------------------------------------
;Poison Knife wbicie
[StateDef 40553]
type = A
movetype= A
physics = N
juggle  = 3
velset = 0,0
ctrl = 0
sprpriority = 2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S2,1

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = time = 0
anim = 40551
pos = 5,3
postype = p1
scale =  0.7,0.7
sprpriority = 3
removetime = 65

[State 0, ModifyExplod]
type = ModifyExplod
trigger1 = time >= 35
ID = 40551
trans = addalpha
alpha = 256-(time-35)*9.6,(time-35)*9.6

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = -45

[State 6002, NotHitBy]
type = NotHitBy
trigger1 = !time
value = SCA
time = -1

[State 1012, Trans]
type = Trans
trigger1 = time >= 35
trans = addalpha
alpha = 256-(time-35)*9.6,(time-35)*9.6

[State 0, PosSet]
type = PosSet
trigger1 = 1
y = 0

[State 0, DestroySelf]
type = DestroySelf
trigger1 = time = 65

;---------------------------------------------------------------------------
;Karasu Come back
[Statedef 40600]
type    = S
movetype= I
physics = S
juggle  = 4
poweradd= -80
velset = 0,0
ctrl = 0
anim = 40600

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = F3,2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = F31

[State 0, AfterImage]
type = AfterImage
trigger1 = time = 0
time = 25
length = 10
palcolor = 256
palinvertall = 0
palbright = 0,0,0
palcontrast = 160,150,150
palpostbright = 0,0,0
paladd = 5,0,0
palmul = .65,.65,.75
timegap = 1
framegap = 1
trans = add

[State 0, Explod]
type = Explod
trigger1 = 1
anim = F20
ID = 20
pos = 10-random%20,-10-random%50
postype = p1  ;P2,front,back,left,right
scale = 0.8,0.4
vel = 2,0
sprpriority = 0
bindtime = 1
ownpal = 1
ontop = 0
supermovetime = 9999
pausemovetime = 9999

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = time = 0 && pos y > -5
anim = F676
ID = 24
pos = -15,4
postype = p1  ;P2,front,back,left,right
scale = 0.4,0.25
vel = 1,0
sprpriority = 2
bindtime = 1
facing = -1
ownpal = 1
ontop = 0
supermovetime = 9999
pausemovetime = 9999

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = animelem = 5
anim = F401
ID = 24
pos = -20,0
postype = p1  ;P2,front,back,left,right
scale = 0.7,0.7
vel = 0.1,0
sprpriority = 2
bindtime = 5
facing = 1
ownpal = 1
ontop = 0
supermovetime = 9999
pausemovetime = 9999

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S2,8

[State 0, Turn]
type = Turn
triggerall = animelem = 3
trigger1 = facing != parent, facing

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
x = -5

[State 0, PosSet]
type = PosSet
trigger1 = animelem = 3
x = parent, pos x + 70*facing
y = parent, pos y

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 4
x = -5

[State 200, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 130

;---------------------------------------------------------------------------
;Karasu Come forward
[Statedef 40650]
type    = S
movetype= A
physics = S
juggle  = 4
poweradd= -80
ctrl = 0
anim = 40650

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = F3,2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = F31

[State 0, AfterImage]
type = AfterImage
trigger1 = time = 0
time = 25
length = 10
palcolor = 256
palinvertall = 0
palbright = 0,0,0
palcontrast = 160,150,150
palpostbright = 0,0,0
paladd = 5,0,0
palmul = .65,.65,.75
timegap = 1
framegap = 1
trans = add

[State 0, Explod]
type = Explod
trigger1 = 1
anim = F20
ID = 20
pos = -10+random%20,-10-random%50
postype = p1  ;P2,front,back,left,right
scale = 0.8,0.4
vel = -2,0
sprpriority = 0
bindtime = 1
ownpal = 1
ontop = 0
supermovetime = 9999
pausemovetime = 9999

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = time = 0 && pos y > -5
anim = F676
ID = 24
pos = 15,4
postype = p1  ;P2,front,back,left,right
scale = 0.4,0.25
vel = -1,0
sprpriority = 2
bindtime = 1
ownpal = 1
ontop = 0
supermovetime = 9999
pausemovetime = 9999

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = animelem = 5
anim = F401
ID = 24
pos = 20,0
postype = p1  ;P2,front,back,left,right
scale = 0.7,0.7
vel = 0.1,0
sprpriority = 2
bindtime = 5
facing = -1
ownpal = 1
ontop = 0
supermovetime = 9999
pausemovetime = 9999

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S2,8

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
x = 6

[State 200, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = AnimElem = 5
attr = S, NA                     ;Attribute: Standing, Normal Attack
getpower = 0,0
givepower = 0,0
damage = 30,4                 ;Damage that move inflicts, guard damage
animtype = Light                 ;Animation type: Light, Medium, Heavy, Back (def: Light)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 3, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default                                 ;Hit/Miss/Dodge type (Def: Hit)
pausetime = 0,5                 ;Time attacker pauses, time opponent shakes
sparkno = 42642              ;Spark anim no (Def: set above)
sparkxy = -15,-42                 ;Spark x y
hitsound = 5, 24646
guardsound = 6, 0               ;Sound to play on guard
ground.type = High               ;Type: High, Low, Trip (def: Normal)
ground.slidetime = 5             ;Time that the opponent slides back
ground.hittime  = 25             ;Time opponent is in hit state
ground.velocity = 0             ;Velocity at which opponent is pushed
airguard.velocity = 0,-.8     ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
air.velocity = 0,-1           ;X-velocity at which opponent is pushed,
                                 ;Y-velocity at which opponent is pushed
air.hittime = 0                 ;Time before opponent regains control in air

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
v = 1
value = Abs(enemy(cond((enemy(0),alive),0,1)), pos x - pos x)

[State 0, PosSet]
type = PosSet
trigger1 = animelem = 3
trigger1 = var(1) < 350
x = enemy(cond((enemy(0),alive),0,1)), pos x - 70*facing
y = enemy(cond((enemy(0),alive),0,1)), pos y

[State 0, PosSet]
type = PosSet
trigger1 = animelem = 3
trigger1 = var(1) >= 350
x = pos x + 350*facing
y = enemy(cond((enemy(0),alive),0,1)), pos y

[State 0, VelSet]
type = VelSet
trigger1 = animelem = 4
x = 6

[State 200, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 40000

;---------------------------------------------------------------------------
;Karasu  Counter
[Statedef 40700]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 40700                       ;Change animation (Def: no change)
poweradd = -250
velset = 0,0                    ;Power to add (Def: 0)
sprpriority = 2                  ;Set p1's sprite layering priority to 2 (in front)

[State 310, 2]
type = Explod
trigger1 = AnimElem = 3 && pos y >= -20
anim = F290
ID = 290
pos = 0,-pos y+5
postype = p1
facing = 1
bindtime = 1
removetime = -2
sprpriority = 4
scale = 1.5,1.5

[State 0, NotHitBy]
type = NotHitBy
triggerall = time = 0
trigger2 = parent, stateno = 1700
trigger1 = prevstateno = [5000,5900]
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 33

[State 0, VelSet]
type = VelSet
trigger1 = time < 24
x = 3
y = 0

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = time = [8,24]
trigger1 = timemod = 5,0
anim = F1391
ownpal = 1
pos = 15,-30
scale = 0.4,0.4
removetime = -2
sprpriority=4
postype = p1
ownpal = 1
angle = 260+atan(vel y/vel x)*180/PI

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = pos y > -6
trigger1 = timemod = 5,0
trigger1 = vel x > 0
anim = F300
ownpal = 1
ID = 60
pos = -13,-pos y+3
scale = 1,1
removetime = -2
sprpriority=1
postype = p1
ownpal = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 =  animelem = 5
value = S2,9

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3
trigger2 = animelem = 8
value = S2,8

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
value = F8,0+random%5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 2
value = F24,0+random%5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time < 20 && timemod = 10,0
value = S2,13

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = movehit = 1 && p2movetype = H
anim = F10+random%2
angle = -25+random%50
pos = -15,-30-random%10
postype = p2  ;p2,front,back,left,right
facing = 1
bindtime = 1
removetime = -2
sprpriority = 3
scale = 1,1
ownpal = 1
ontop = 0
supermovetime = 9999
pausemovetime = 9999

[State 200, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = time < 20 && timemod = 5,0
attr = S, NA                     ;Attribute: Standing, Normal Attack
damage = 5,2                 ;Damage that move inflicts, guard damage
animtype = Light                 ;Animation type: Light, Medium, Heavy, Back (def: Light)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 3, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default                                 ;Hit/Miss/Dodge type (Def: Hit)
pausetime = 1,2                 ;Time attacker pauses, time opponent shakes
sparkno = 0+random%4                 ;Spark anim no (Def: set above)
sparkxy = -15,-30                ;Spark x y
                                ;Y-offset for the spark rel. to p1
hitsound = 24, 2                  ;Sound to play on hit
guardsound = 21, 7                ;Sound to play on guard
ground.type = High               ;Type: High, Low, Trip (def: Normal)
ground.slidetime = 5             ;Time that the opponent slides back
ground.hittime  = 25             ;Time opponent is in hit state
ground.velocity = -3,-2             ;Velocity at which opponent is pushed
airguard.velocity = -3,-2     ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
air.velocity = -3,-2          ;X-velocity at which opponent is pushed,
                               ;Y-velocity at which opponent is pushed
air.hittime = 25 
envshake.time = 10
envshake.freq = 20
envshake.ampl = -5
envshake.phase = 10               ;Time before opponent regains control in air

[State 200, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = AnimElem = 6
attr = S, NA                     ;Attribute: Standing, Normal Attack
damage = 20,5                 ;Damage that move inflicts, guard damage
animtype = Light                 ;Animation type: Light, Medium, Heavy, Back (def: Light)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 3, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default                                 ;Hit/Miss/Dodge type (Def: Hit)
pausetime = 1,2                 ;Time attacker pauses, time opponent shakes
sparkno = 0+random%4              ;Spark anim no (Def: set above)
sparkxy = -20,-40                ;Spark x y
                                ;Y-offset for the spark rel. to p1
hitsound = 24, 2                  ;Sound to play on hit
guardsound = 21, 7                ;Sound to play on guard
ground.type = High               ;Type: High, Low, Trip (def: Normal)
ground.slidetime = 5             ;Time that the opponent slides back
ground.hittime  = 25             ;Time opponent is in hit state
ground.velocity = -5,-2             ;Velocity at which opponent is pushed
airguard.velocity = -5,-2     ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
air.velocity = -5,-2           ;X-velocity at which opponent is pushed,
fall = 1                               ;Y-velocity at which opponent is pushed
air.hittime = 25
envshake.time = 30
envshake.freq = 30
envshake.ampl = -7
envshake.phase = 10

[State 0, TargetState]
type = TargetState
trigger1 = enemy(cond((enemy(0),alive),0,1)), var(30) = 0
trigger1 = movehit
value = 106000

[State 200, 2]
type = ChangeState
trigger1 = AnimTime = 0
value = 40000

;---------------------------------------------------------------------------
;Karasu Kawarimi
[Statedef 40710]
type    = S
movetype= I
physics = S
juggle  = 4
poweradd= 0
ctrl = 0
velset = 0,0
anim = 40710

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
v = 3
value = parent, pos x

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
v = 4
value = parent, pos y

[State 0, NotHitBy]
type = NotHitBy
trigger1 = time >= 0
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 30

[State 500, PosAdd]
type = Posset
trigger1 = Time = 5
x = var(3)
y = var(4)

[State 0, Prawa]
type = Explod
trigger1 = time = 6
anim = F696
ownpal = 1
ID = 900
pos = 10+random%10,-20-random%20
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
supermovetime = 9999
pausemovetime = 9999
vel = 0+random%2,-1-random%3
scale = 0.9,0.9
sprpriority = 5
ontop = 0

[State 0, Srodek]
type = Explod
trigger1 = time = 6
anim = F696
ownpal = 1
ID = 900
pos = -5+random%10,-10-random%10
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
supermovetime = 9999
pausemovetime = 9999
vel = -1+random%3,-1-random%2
scale = 1.4,1.4
sprpriority = 5
ontop = 0

[State 0, Lewa]
type = Explod
trigger1 = time = 6
anim = F696
ownpal = 1
ID = 900
pos = -10-random%10,-20-random%20
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
bindtime = 1
removetime = -2
supermovetime = 9999
pausemovetime = 9999
vel = 0-random%2,-1-random%3
scale = 0.9,0.9
sprpriority = 5
ontop = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 6
value = F9,0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 6
value = F9,2

[State 0, Turn]
type = Turn
trigger1 = facing = -1 && enemynear(cond((enemynear(0),alive),0,1)), pos x > pos x
trigger2 = facing = 1 && enemynear(cond((enemynear(0),alive),0,1)), pos x < pos x

[State 0, VelSet]
type = VelSet
trigger1 = 1
x = 0
y = 0

[State 500]
type = ChangeState
trigger1 = Time = 10
value = 40700
ctrl = 0

;---------------------------------------------------------------------------
;Karasu  Hand Killer
[Statedef 40800]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= I                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 40800                       ;Change animation (Def: no change)
poweradd = -750
velset = 0,0                    ;Power to add (Def: 0)
sprpriority = 3                  ;Set p1's sprite layering priority to 2 (in front)

[State 0, SuperPause]
type = SuperPause
trigger1 = time = 0
time = 100
movetime = 100
pos = 0,-30
sound = F19,36575
anim = 654646
darken = 1
unhittable = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = F8,0+random%4

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S2,8

[State 0, Turn]
type = Turn
trigger1 = pos x > enemy(cond((enemy(0),alive),0,1)), pos x && facing = 1
trigger2 = pos x < enemy(cond((enemy(0),alive),0,1)), pos x && facing = -1

[State 1640, X]
Type=VarSet
Trigger1= 1
fvar(13)=(enemy(cond((enemy(0),alive),0,1)),Pos X-Pos X)*Facing

[State 1640, Y]
Type=VarSet
trigger1= 1
fvar(14)=(enemy(cond((enemy(0),alive),0,1)),pos Y-Pos Y)-17

[State 1640, Vector Length]
Type=VarSet
trigger1= 1
fvar(15)=Exp(0.5*ln((fvar(13)*fvar(13))+(fvar(14)*fvar(14))))

[State 0, Helper]
type = Helper
trigger1 = animelem = 4
helpertype = normal
name = "hand 1 "
ID = 40810
stateno = 40810
pos = -18,-29
postype = p1
facing = 1
keyctrl = 0
supermovetime = 100

[State 0, Helper]
type = Helper
trigger1 = animelem = 4
helpertype = normal
name = "hand 2"
ID = 40811
stateno = 40811
pos = 4,-20
postype = p1
facing = 1
keyctrl = 0
supermovetime = 100

[State 0, Helper]
type = Helper
trigger1 = animelem = 4
helpertype = normal
name = "hand 3"
ID = 40812
stateno = 40812
pos = -10,-18
postype = p1
facing = 1
keyctrl = 0
supermovetime = 100

[State 0, Helper]
type = Helper
trigger1 = animelem = 4
helpertype = normal
name = "hand 4"
ID = 40813
stateno = 40813
pos = -5,-13
postype = p1
facing = 1
keyctrl = 0
supermovetime = 100

[State 200, 2]
type = ChangeState
trigger1 = helper(40810), stateno = 40816
trigger2 = helper(40811), stateno = 40816
trigger3 = helper(40812), stateno = 40816
trigger4 = helper(40813), stateno = 40816
value = 40801

[State 200, 2]
type = ChangeState
trigger1 = numhelper(40810) = 0
trigger1 = numhelper(40811) = 0
trigger1 = numhelper(40812) = 0
trigger1 = numhelper(40813) = 0
trigger1 = numhelper(60810) = 0
trigger1 = numhelper(60811) = 0
trigger1 = numhelper(60812) = 0
trigger1 = numhelper(60813) = 0
trigger1 = time > 20
value = 40801

;---------------------------------------------------------------------------
; Karasu hand killer end
[Statedef 40801]
type = S
physics = S
movetype= I
juggle  = 4
ctrl = 0
anim = 40801

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time%5 = 0
value = S2,13

[State 0, ChangeState]
type = ChangeState
trigger1 = animtime = 0
value = 40000
ctrl = 0

;---------------------------------------------------------------------------
;Hand 1
[Statedef 40810]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= I                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 40810                      ;Change animation (Def: no change)
poweradd = 0
velset = 0,0                    ;Power to add (Def: 0)
sprpriority = 4                  ;Set p1's sprite layering priority to 2 (in front)

[State 0, AngleDraw]
type = AngleDraw
trigger1 = parent, time < 70
value = 36

[State 0, BindToParent]
type = BindToParent
trigger1 = 1
time = 1
facing = 1
pos = -18,-29

[State 1640, Y]
Type=VarSet
trigger1= 1
fvar(13)= (parent,Fvar(13))/(parent,fvar(15))

[State 1640, Y]
Type=VarSet
trigger1= 1
fvar(14)=(parent,FVar(14))/(parent,fvar(15))

[State 0, AngleDraw]
type = Angleset
trigger1 =  parent, time >= 70
value = (atan(fvar(14)/fvar(13))+(4*Pi/2))*(-180/Pi) + 36

[State 0, AngleDraw]
type = Angledraw
trigger1 = 1

[State 200, 2]
type = ChangeState
trigger1 = time = 95
value = 40815

[State 200, 2]
type = ChangeState
trigger1 = parent, stateno != 40800
trigger1 = parent, stateno != 40801
trigger1 = parent, stateno != 60800
trigger1 = parent, stateno != 60801
value = 40817

;---------------------------------------------------------------------------
;Hand 2
[Statedef 40811]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= I                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 40810                      ;Change animation (Def: no change)
poweradd = 0
velset = 0,0                    ;Power to add (Def: 0)
sprpriority = 1

[State 0, BindToParent]
type = BindToParent
trigger1 = 1
time = 1
facing = 1
pos = 4,-20

[State 0, AngleDraw]
type = AngleDraw
trigger1 = parent, time < 70
value = 36

[State 1640, Y]
Type=VarSet
trigger1= 1
fvar(13)= (parent,Fvar(13))/(parent,fvar(15))

[State 1640, Y]
Type=VarSet
trigger1= 1
fvar(14)=(parent,FVar(14))/(parent,fvar(15))

[State 0, AngleDraw]
type = Angleset
trigger1 =  parent, time >= 70
value = (atan(fvar(14)/fvar(13))+(4*Pi/2))*(-180/Pi) + 36

[State 0, AngleDraw]
type = Angledraw
trigger1 = 1

[State 200, 2]
type = ChangeState
trigger1 = time = 100
value = 40815

[State 200, 2]
type = ChangeState
trigger1 = parent, stateno != 40800
trigger1 = parent, stateno != 40801
trigger1 = parent, stateno != 60800
trigger1 = parent, stateno != 60801
value = 40817

;---------------------------------------------------------------------------
;Hand 3
[Statedef 40812]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= I                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 40810                      ;Change animation (Def: no change)
poweradd = 0
velset = 0,0                    ;Power to add (Def: 0)
sprpriority = 4

[State 0, BindToParent]
type = BindToParent
trigger1 = 1
time = 1
facing = 1
pos = -10,-18

[State 0, AngleDraw]
type = AngleDraw
trigger1 = parent, time < 70
value = 36

[State 1640, Y]
Type=VarSet
trigger1= 1
fvar(13)= (parent,Fvar(13))/(parent,fvar(15))

[State 1640, Y]
Type=VarSet
trigger1= 1
fvar(14)=(parent,FVar(14))/(parent,fvar(15))

[State 0, AngleDraw]
type = Angleset
trigger1 =  parent, time >= 70
value = (atan(fvar(14)/fvar(13))+(4*Pi/2))*(-180/Pi) + 36

[State 0, AngleDraw]
type = Angledraw
trigger1 = 1

[State 200, 2]
type = ChangeState
trigger1 = time = 105
value = 40815

[State 200, 2]
type = ChangeState
trigger1 = parent, stateno != 40800
trigger1 = parent, stateno != 40801
trigger1 = parent, stateno != 60800
trigger1 = parent, stateno != 60801
value = 40817

;---------------------------------------------------------------------------
;Hand 4
[Statedef 40813]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= I                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 40810                      ;Change animation (Def: no change)
poweradd = 0
velset = 0,0                    ;Power to add (Def: 0)
sprpriority = 1                  ;Set p1's sprite layering priority to 2 (in front)

[State 0, BindToParent]
type = BindToParent
trigger1 = 1
time = 1
facing = 1
pos = -5,-13


[State 0, AngleDraw]
type = AngleDraw
trigger1 = parent, time < 70
value = 36

[State 1640, Y]
Type=VarSet
trigger1= 1
fvar(13)= (parent,Fvar(13))/(parent,fvar(15))

[State 1640, Y]
Type=VarSet
trigger1= 1
fvar(14)=(parent,FVar(14))/(parent,fvar(15))

[State 0, AngleDraw]
type = Angleset
trigger1 =  parent, time >= 70
value = (atan(fvar(14)/fvar(13))+(4*Pi/2))*(-180/Pi) + 36

[State 0, AngleDraw]
type = Angledraw
trigger1 = 1

[State 200, 2]
type = ChangeState
trigger1 = time = 110
value = 40815

[State 200, 2]
type = ChangeState
trigger1 = parent, stateno != 40800
trigger1 = parent, stateno != 40801
trigger1 = parent, stateno != 60800
trigger1 = parent, stateno != 60801
value = 40817

;---------------------------------------------------------------------------
; Hand killer
[Statedef 40815]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 40811                      ;Change animation (Def: no change)
poweradd = 0
velset = 0,0                   ;Power to add (Def: 0)

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = target, ishelper = 0
flag = unguardable

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = F8,0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = random%1
value = S2,10

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = F24,0+random%5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S2,10

[State 0, VelSet]
type=VelSet
trigger1= !movehit
x= fvar(13)*18
y= fvar(14)*18

[State 0, AngleDraw]
type = Angleset
trigger1 = 1
value = (atan(fvar(14)/fvar(13))+(4*Pi/2))*(-180/Pi) + 36

[State 0, AngleDraw]
type = Angledraw
trigger1 = 1

[State 450, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = !time
attr = C,HP
damage = 75,15
getpower = 0,0
givepower = 0,0
animtype = Light
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 0, 1
sparkno = 10+random%3
sparkxy = -10, 0
hitsound = F24,10+random%5
guardsound = 6, 0
ground.type = High
ground.velocity = 0,0
air.velocity = 0,0
fall = 1
fall.recover = 0
p2stateno = 106003

;trafienie w ziemi

[State 0, VelSet]
type=VelSet
trigger1= movehit
trigger2 = pos y > 0
x= 0
y= 0

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = pos y > 0 && anim != 40813
value = 40813

[State 0, PlaySnd]
type = PlaySnd
trigger1 = pos y > 0 && numexplod(40800) = 0 && !movehit
value = S2,1

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = pos y > 0 && numexplod(40800) = 0 && !movehit
ID = 40800
anim = 40551
pos = 12,12
postype = p1
scale =  1,1
sprpriority = 5
removetime = -1

;trafienie w przeciwnika
[State 1640, Y]
Type=VarSet
trigger1= movehit && var(13) = 0
var(13)= facing*random%11

[State 1640, Y]
Type=VarSet
trigger1= movehit && var(14) = 0
var(14)= Enemy,Pos Y - pos Y

[State 0, PosSet]
type = PosSet
trigger1 = movehit
x = Enemy,Pos X - var(13)
y = Enemy,Pos Y - var(14)

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = movehit && anim != 40812
value = 40812

[State 0, SprPriority]
type = SprPriority
trigger1 = anim = 40812
value = 1+ishelper(40811)+ishelper(40813)+ishelper(60811)+ishelper(60813)

[State 0, DestroySelf]
type = DestroySelf
trigger1 = frontedgebodydist < -50
ignorehitpause = 1

[State 200, 2]
type = ChangeState
trigger1 = ishelper(40810)
trigger2 = ishelper(60810)
triggerall = time = 85
triggerall = Abs(parent, pos x - pos x)<500
value = 40816

[State 200, 2]
type = ChangeState
trigger2 = ishelper(40811)
trigger1 = ishelper(60811)
triggerall = time = 80
triggerall = Abs(parent, pos x - pos x)<500
value = 40816

[State 200, 2]
type = ChangeState
trigger2 = ishelper(40812)
trigger1 = ishelper(60812)
triggerall = time = 75
triggerall = Abs(parent, pos x - pos x)<500
value = 40816

[State 200, 2]
type = ChangeState
trigger2 = ishelper(40813)
trigger1 = ishelper(60813)
triggerall = time = 70
triggerall = Abs(parent, pos x - pos x)<500
value = 40816

[State 200, 2]
type = ChangeState
trigger1 = enemynear(0), life = 0
trigger1 = movehit
value = 40816

[State 200, 2]
type = ChangeState
trigger1 = parent, stateno != 40800
trigger1 = parent, stateno != 40801
trigger1 = parent, stateno != 60800
trigger1 = parent, stateno != 60801
trigger2 = Abs(parent, pos x - pos x)>=500
trigger2 = time > 100
value = 40817

;---------------------------------------------------------------------------
; Hand killer end
[Statedef 40816]
movetype= I                      ;Move-type: A-attack, I-idle, H-gethit
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 42442                     ;Change animation (Def: no change)
poweradd = 0
velset = 0,0                    ;Power to add (Def: 0)

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = time = 0
id =  40800

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S2,10


[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = F24,0+random%5

[State 1640, X]
Type=VarSet
Trigger1= time = 0
fvar(13)=(parent,Pos X-Pos X)*Facing

[State 1640, Y]
Type=VarSet
trigger1= time = 0
fvar(14)=(parent,pos Y-Pos Y)-10

[State 1640, Alfa]
Type=VarSet
trigger1= time = 0
fvar(15)= Atan(fvar(14)/fvar(13))

[State 0, VelSet]
type=VelSet
trigger1= 1
x= -cos(fvar(15))*18
y= -sin(fvar(15))*18

[State 0, AngleDraw]
type = Angleset
trigger1 = 1
value = -fvar(15)*180/PI+30

[State 0, AngleDraw]
type = Angledraw
trigger1 = 1

[State 0, DestroySelf]
type = DestroySelf
trigger1 = pos x - parent, pos x = [-10,10]

[State 200, 2]
type = ChangeState
trigger1 = parent, stateno != 40800
trigger1 = parent, stateno != 40801
trigger1 = parent, stateno != 60800
trigger1 = parent, stateno != 60801
value = 40817

;---------------------------------------------------------------------------
; Karasu hand killer end
[Statedef 40817]
type = S
physics = S
movetype= I
juggle  = 4
ctrl = 0
velset = 0,0
anim = 40815

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
trigger1 = prevstateno != 40815
value = S2,1

[State 0, RemoveExplod]
type = RemoveExplod
trigger1 = time = 0
id =  40800

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, Trans]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256

[State 0, ChangeState]
type = destroyself
trigger1 = animtime = 0

;------------------------------------------------------------------
;Karasu puppet rendan
[StateDef 40900]
type = S
movetype= A
physics = N
juggle  = 3
velset = 0,0
ctrl = 0
sprpriority = 3
poweradd = 0
anim = 40900

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = S2,8

[State 0, PlaySnd]
type = PlaySnd
trigger1 = timemod = 25,0
trigger1 = parent, stateno != 2000
value = S2,8
channel = 2

[State 1640, X]
Type=VarSet
Trigger1= 1
fvar(13)=(enemynear(cond((enemynear(0),alive),0,1)),Pos X-Pos X)*Facing

[State 1640, Y]
Type=VarSet
trigger1= 1
fvar(14)=(enemynear(cond((enemynear(0),alive),0,1)),pos Y-Pos Y)-10

[State 1640, Vector Length]
Type=VarSet
trigger1= 1
fvar(15)=Exp(0.5*ln((fvar(13)*fvar(13))+(fvar(14)*fvar(14))))

[State 0, VelSet]
type=VelSet
trigger1= time = 0
x=(Fvar(13))/(fvar(15))*12
y=(FVar(14))/(fvar(15))*12

[State 0, AngleSet]
type = AngleSet
trigger1 = 1
value = (atan(Vel Y/Vel X)+(4*Pi/2))*(-180/Pi)

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1

[State 200, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = !movecontact
attr = S, NA                     ;Attribute: Standing, Normal Attack
getpower = 0,0
givepower = 0,0
damage = 40,8                ;Damage that move inflicts, guard damage
animtype = Light                 ;Animation type: Light, Medium, Heavy, Back (def: Light)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 3, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default                                 ;Hit/Miss/Dodge type (Def: Hit)
pausetime = 3,1                 ;Time attacker pauses, time opponent shakes
sparkno = 455256                 ;Spark anim no (Def: set above)
sparkxy = -15,-34                 ;Spark x y
                                ;Y-offset for the spark rel. to p1
hitsound = S2, 246                  ;Sound to play on hit
guardsound = 6, 0                ;Sound to play on guard
ground.type = High               ;Type: High, Low, Trip (def: Normal)
ground.slidetime = 5             ;Time that the opponent slides back
ground.hittime  = 200           ;Time opponent is in hit state
ground.velocity = -1,vel y             ;Velocity at which opponent is pushed
airguard.velocity = -1,vel y     ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
air.velocity = -1,vel y             ;X-velocity at which opponent is pushed,
                                 ;Y-velocity at which opponent is pushed
air.hittime = 200
p2stateno = 106004

[State 0, ScreenBound]
type = ScreenBound
trigger1 = movehit
value = 0
movecamera = 0,0

[State 0, VelSet]
type=Velset
trigger1= movehit && vel y > 0
y = -3
x = 8

[State 0, VelAdd]
type = VelAdd
trigger1 = movehit
y = -0.5

[State 0, ChangeState]
type = Changeanim
trigger1 = movehit
trigger1 = anim != 40901
value = 40901

[State 0, TargetBind]
type = TargetBind
trigger1 = movecontact
time = 2
pos = -5,11

[State 1210, end]
type = changeState
trigger1 = pos y < -440
value = 40910

[State 1210, end]
type = changeState
trigger1 = time = 55 && !movecontact
value = 40000

[State 1210, end]
type = changeState
trigger1 = moveguarded
trigger2 = pos y > 0
value = 40920

[State 0, AfterImage]
type = AfterImage
trigger1 = time = 5
time = 17
length = 10
palcolor = 256
palinvertall = 0
palbright = 0,0,0
palcontrast = 160,150,150
palpostbright = 0,0,0
paladd = 0,0,0
palmul = .65,.65,.75
timegap = 1
framegap = 1
trans = add

;------------------------------------------------------------------
;Karasu puppet rendan end
[StateDef 40910]
type = S
movetype= A
physics = N
juggle  = 3
velset = 0,11
ctrl = 0
sprpriority = 3
anim = 40910
poweradd = -1000

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = F14,6

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = timemod = 5,0
anim = F1391
ownpal = 1
pos = 0,20
scale = 0.5,0.5
removetime = -2
sprpriority=5
postype = p1
ownpal = 1
angle = 250

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time%10 = 0
value = F8,1

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = time%8 = 0
trigger1 = !movecontact
anim = 40915
ID = 40915
pos = 0,150
postype = p1  ;p2,front,back,left,right
facing = 1
vfacing = 1
removetime = -2
scale = 0.9,0.9
sprpriority = 4

[State 210, 2]
type = AfterImage
trigger1 = time = 0
time = 35
length = 20
palbright = 0,0,0
palcontrast = 160,150,150
palpostbright = 0,0,0
paladd = 5,0,0
palmul = 1,1,1
trans = add1

[State 0, TargetBind]
type = TargetBind
trigger1 = !movecontact
time = 2
pos = 0,30

[State 0, PosSet]
type = Posset
trigger1 = time = 0
y = -440

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
value = 180

[State 0, PlaySnd]
type = PlaySnd
trigger1 = movecontact
value = F15,2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = movecontact
value = F15,4

[State 200, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = pos y > -60
attr = S, NA                     ;Attribute: Standing, Normal Attack
getpower = 0,0
givepower = 0,0
damage = 450,250                 ;Damage that move inflicts, guard damage
animtype = Light                 ;Animation type: Light, Medium, Heavy, Back (def: Light)
guardflag = MA                   ;Flags on how move is to be guarded against
hitflag = MAF                    ;Flags of conditions that move can hit
priority = 3, Hit                ;Attack priority: 0 (least) to 7 (most), 4 default                                 ;Hit/Miss/Dodge type (Def: Hit)
pausetime = 3,1                 ;Time attacker pauses, time opponent shakes
sparkno = 0                ;Spark anim no (Def: set above)
sparkxy = -15,-34                 ;Spark x y
                                ;Y-offset for the spark rel. to p1
hitsound = S2, 3                  ;Sound to play on hit
guardsound = 6, 0                ;Sound to play on guard
ground.type = High               ;Type: High, Low, Trip (def: Normal)
ground.slidetime = 5             ;Time that the opponent slides back
ground.hittime  = 200           ;Time opponent is in hit state
ground.velocity = 0,-3             ;Velocity at which opponent is pushed
airguard.velocity = 0,0    ;Guard velocity in air (def: (air.xvel*1.5, air.yvel/2))
air.type = High                  ;Type: High, Low, Trip (def: same as ground.type)
air.velocity = 0,-3             ;X-velocity at which opponent is pushed,
                                 ;Y-velocity at which opponent is pushed
air.hittime = 200
fall = 1
fall.recover = 0

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = movecontact
anim = F210
ID = 40900
pos = 20,5
postype = p1  ;p2,front,back,left,right
sprpriority = 4
scale = 1.5,1.5
facing = 1
removetime = -2

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = movecontact
anim = F61
ID = 40900
pos = 20,0
postype = p1  ;p2,front,back,left,right
sprpriority = 3
scale = 1.4,1.4
facing = 1
removetime = -2

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = movecontact
anim = F540
ID = 40900
pos = 20,0
postype = p1  ;p2,front,back,left,right
sprpriority = 3
scale = 1.5,1.5
facing = 1
removetime = -2


[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = movecontact
anim = F1190
ID = 40900
pos = 20,0
postype = p1  ;p2,front,back,left,right
sprpriority = 3
scale = 1.5,1.5
facing = 1
removetime = -2

[State 1210, end]
type = changeState
trigger1 = movecontact
trigger2 = win
trigger3 = lose
trigger4 = pos y >= -20
value = 40105

;------------------------------------------------------------------
;Karasu puppet rendan guarded
[StateDef 40920]
type = S
movetype= A
physics = N
juggle  = 3
velset = -3,-2
ctrl = 0
sprpriority = 3
anim = 40920

[State 0, Explod]
type = removeExplod
trigger1 = time=0
ID = 40951

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = S2,8

[State 0, VelAdd]
type = VelAdd
trigger1 = 1
x = 0.12
y = 0.08

[State 1210, end]
type = changeState
trigger1 = animtime = 0
value = 40000

;------------------------------------------------------------------
;Karasu tatsumaki
[StateDef 40950]
type = S
movetype= A
physics = N
juggle  = 3
velset = 0,0
ctrl = 0
sprpriority = 3
poweradd = 0
anim = 40950

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = pos y > -6
trigger1 = timemod = 5,0
trigger1 = vel x > 0
anim = F300
ownpal = 1
ID = 60
pos = -13,-pos y+3
scale = 1,1
removetime = -2
sprpriority=1
postype = p1
ownpal = 1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4
trigger2 = animelem = 7
trigger3 = animelem = 10
trigger4 = animelem = 12
value = S2,13

[State 0, PlaySnd]
type = PlaySnd
trigger1 =  animelem = 2
trigger2 = timemod = 20,0
value = S2,9

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 3
trigger2 = timemod = 20,0
value = S2,8

[State 0, VarSet]
type = VarSet
trigger1 = time = 0
v = 6
value = 0

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = animelem = 3
anim = 40951
ID = 40951
pos = 0,0
postype = p1  ;p2,front,back,left,right
sprpriority = 3
facing = 1
bindtime = -1
removeongethit = 1
removetime = -1
supermovetime = 60

[State 0, Explod]
type = modifyExplod
trigger1 = time=[14,60]
ID = 40951
trans = addalpha
alpha = (time-14)*5.56,256

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = time = 60 && pos y >= -30
anim = F380
ID = 380
pos = -20,-pos y
postype = p1  ;p2,front,back,left,right
sprpriority = 4
facing = 1
removetime = -2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 60
value = F31

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = time = 60 && pos y >= -30
anim = F340
ID = 340
pos = 0,-pos y-30
postype = p1  ;p2,front,back,left,right
sprpriority = 4
facing = -1
scale = 1.3,1.3
removetime = -2

[State 0, SuperPause]
type = SuperPause
trigger1 = time = 0
time = 60
movetime = 60
anim = -1
sound = -1
darken = 1
unhittable = 0

[State 0, VelSet]
type = VelSet
trigger1 = time = 60
x = 8.4

[State 0, VelSet]
type = Veladd
trigger1 = time > 60
x = 0.2

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4
value = F8,0+random%5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4
value = F24,0+random%5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time > 60 && timemod = 10,0
value = S2,13

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = movehit = 1 && p2movetype = H
anim = F10+random%2
angle = -25+random%50
pos = -10,-30
postype = p2  ;p2,front,back,left,right
facing = 1
bindtime = 1
removetime = -2
sprpriority = 3
scale = 0.75,0.75
ownpal = 1
ontop = 0
supermovetime = 9999
pausemovetime = 9999

[State 0, HitDef]
type = HitDef
fall.yvelocity = -6
trigger1 = time > 60
attr = S,NA        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = MAF        ;HLAFD+-
guardflag = MA         ;HLA
getpower = 0,0
givepower = 0,0
animtype = light          ;light,medium,hard,back,up,diagup
air.animtype = light
priority = 4,Hit   ;Hit,Miss,Dodge
damage = 20,4
pausetime = 0,0
sparkno = 0+random%4                 ;Spark anim no (Def: set above)
              ;Spark x y
                                ;Y-offset for the spark rel. to p1
hitsound = 24, 2                  ;Sound to play on hit
guardsound = 21, 7 
guard.sparkno = 0
sparkxy = -10-random%17,-35
ground.type = High      ;Low,Trip,None
air.hittime = 20
ground.hittime = 20
ground.velocity = 0,-3
air.velocity = 0,-3

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 1210, end]
type = changeState
trigger1 = movehit
trigger1 = enemynear, stateno=[5000,5999]
value = 40951

[State 1210, end]
type = changeState
trigger1 = frontedgedist < 5
trigger1 = vel x !=0
trigger2 = moveguarded
value = 40920

[State 0, Explod]
type = modifyExplod
trigger1 = time>111
ID = 40951
trans = addalpha
alpha = 256-(time-111)*32,256

[State 0, Explod]
type = removeExplod
trigger1 = time=120
ID = 40951

[State 1210, end]
type = changeState
trigger1 = time = 120
value = 40000

;------------------------------------------------------------------
;Karasu tatsumaki
[StateDef 40951]
type = S
movetype= A
physics = N
juggle  = 3
ctrl = 0
sprpriority = 3
poweradd = -1500


[State 0, PlaySnd]
type = PlaySnd
trigger1 = timemod = 20,0
value = S2,9

[State 0, PlaySnd]
type = PlaySnd
trigger1 = timemod = 20,0
value = S2,8

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4
trigger2 = animelem = 7
trigger3 = animelem = 10
trigger4 = animelem = 12
value = S2,13

[State 0, PosAdd]
type = PosAdd
trigger1 = time = 0
x = 10

[State 0, SprPriority]
type = SprPriority
trigger1 = vel x >= 0
value = 3

[State 0, SprPriority]
type = SprPriority
trigger1 = vel x < 0
value = -10

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = timemod = 5,0
anim = F1391
ownpal = 1
pos = 0,-10
scale = 0.5,0.5
removetime = -2
sprpriority=4
postype = p1
ownpal = 1
angle = 70

[State 210, 2]
type = AfterImage
trigger1 = time = 0
time = 26
length = 26
palbright = 0,0,0
palcontrast = 160,150,150
palpostbright = 0,0,0
paladd = 5,0,0
palmul = 1,1,1
trans = add

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = movehit = 1 && p2movetype = H
anim = F10+random%2
angle = -25+random%50
pos = -10,-30
postype = p2  ;p2,front,back,left,right
facing = 1
bindtime = 1
removetime = -2
sprpriority = 3
scale = 0.75,0.75
ownpal = 1
ontop = 0
supermovetime = 9999
pausemovetime = 9999

[State 0, HitDef]
type = HitDef
fall.yvelocity = -6
trigger1 = timemod = 3,0
attr = S,NA        ;SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
hitflag = MAF        ;HLAFD+-
guardflag = MA         ;HLA
getpower = 0,0
givepower = 0,0
animtype = light          ;light,medium,hard,back,up,diagup
air.animtype = light
priority = 4,Hit   ;Hit,Miss,Dodge
damage = 60,12
pausetime = 0,0
sparkno = 0+random%4                 ;Spark anim no (Def: set above)
              ;Spark x y
                                ;Y-offset for the spark rel. to p1
hitsound = 24, 2                  ;Sound to play on hit
guardsound = 21, 7 
guard.sparkno = 0
sparkxy = -10-random%17,-35
ground.type = High      ;Low,Trip,None
air.hittime = 20
ground.hittime = 20
ground.velocity = 0,vel y-1.3
air.velocity = 0,vel y-1.3
fall = 1

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
y = -3.5
x=0

[State 0, VelSet]
type = Veladd
trigger1 = 1
y = -0.10

[State 0, VelSet]
type = VelSet
trigger1 = 1
x = cos(time/3.5-PI/4)*14/(1+time*0.06)

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 1210, end]
type = changeState
trigger1 = vel y <= -6.5
value = 40952

;------------------------------------------------------------------
;Karasu tatsumaki end
[StateDef 40952]
type = S
movetype= A
physics = N
juggle  = 3
ctrl = 0
sprpriority = 3
anim = 40952
poweradd = 0

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 1
value = S2,9

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 1
value = S2,8

[State 0, Explod]
type = modifyExplod
trigger1 = time<9
ID = 40953
scale = 0.7+time*0.1,0.7+time*0.04
trans = addalpha
alpha = 256-time*32,256

[State 0, Explod]
type = removeExplod
trigger1 = time=9
ID = 40953

[State 0, VelSet]
type = VelSet
trigger1 = time = 0
x = 0

[State 0, VelSet]
type = Veladd
trigger1 = vel y < 0
y = 1

[State 0, VelSet]
type = VelSet
trigger1 = vel y >= 0
x = 0

[State 0, VelSet]
type = removeExplod
trigger1 = time = 0
ID = 40951

[State 1210, end]
type = changeState
trigger1 = animtime = 0
value = 40000
;------------------------------------------------------------------
;Karasu bomb attack
[StateDef 41000]
type = S
movetype= I
physics = N
juggle  = 3
velset = 0,0
ctrl = 0
sprpriority = 3
poweradd = -1000
anim = 40211

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = F31

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 1
value = F3,2

[State 0, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0

[State 0, PosSet]
type = Posadd
trigger1 = animelem = 3
trigger1 = anim = 40211
x = -30-backedgedist
y = -pos y-130

[State 0, ChangeAnim]
type = ChangeAnim
trigger1 = animtime = 0
trigger1 = anim = 40211
value = 40010

[State 0, PlaySnd]
type = PlaySnd
trigger1 = timemod = 25,0
trigger1 = parent, stateno != 2000
value = S2,8
channel = 2

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = facing != var(1)
flag = noshadow

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State 0, VarAdd]
type = Varset
trigger1 = time = 0
v = 1
value = facing

[State 0, VelSet]
type = VelSet
trigger1 = 1
x = 8

[State 0, Turn]
type = Turn
trigger1 = frontedgedist < -110

[State 0, NotHitBy]
type = NotHitBy
trigger1 = facing != var(1)
value = SCA,NA,SA,HA,NP,SP,HP,NT,ST,HT
time = 2

[State 0, Helper]
type = Helper
triggerall = facing = var(1)
triggerall = timemod = 12,1
trigger1 = anim = 40010
helpertype = normal
name = "bomb"
pos = 3,-25
ID = 41005
stateno = 41005
facing = 1
ownpal = 1

[State 0, AngleDraw]
type = AngleDraw
trigger1 = facing != var(1)
scale = 0.5,0.5
value = 0

[State 0, ChangeState]
type = ChangeState
trigger1 = facing = var(1)
trigger1 = backedgedist < -10
trigger1 = time > 20
triggerall = anim = 40010
value = 40000
ctrl = 0

;------------------------------------------------------------------
;Explode bomb
[Statedef 41005]
type = S
movetype= A
physics = N
juggle  = 3
velset = 0,0
anim = 41000
sprpriority = 1

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 0, Veladd]
type=Veladd
trigger1= 1
y= 0.4

[State 0, HitOverride]
type = HitOverride
trigger1 = 1
attr = SCA,NA,SA,HA,NP,SP,HP,ST,HT,NT;SCA, NA, SA, HA, NP, SP, HP
stateno = 70736
time = 1

[State 1003, ChangeState]
type = changestate
trigger1 =  pos Y >= 5 + parent, var(5)
value = 41006

;---------------------------------------------------------------------------
;Explode bomb
[Statedef 41006]
type    = S
movetype= A
physics = S
juggle  = 4
poweradd= 0
velset = 0,0
ctrl = 0
anim = 41005 ; animacja wybuchu explode kunaia

[State 0, EnvShake]
type = EnvShake
trigger1 = time = 0
time = 50
ampl = -7
freq = 50
phase = 230

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = time = 0 && pos y >= -40
anim = F820;580
pos = 0,-pos y+5
angle = 90
scale = 1,2
postype = p1
facing = 1
bindtime = 1
removetime = -2
sprpriority = 4
supermove = 9999
pausemove = 9999
supermovetime = 9999
pausemovetime = 9999
ownpal = 1

[State 0, Explod]
type = Explod
ownpal = 1
trigger1 = 0;time = 0 && pos y >= -40
anim = F1190
pos = 0,-pos y
scale = 1.5,1.3
postype = p1
facing = 1
bindtime = 1
removetime = -2
sprpriority = 5
supermove = 9999
pausemove = 9999
supermovetime = 9999
pausemovetime = 9999
ownpal = 1


[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = F10,1

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = F10,2

[State 0, Trans]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256,256

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 0
value = F15,0

[State 0, AngleDraw]
type = AngleDraw
trigger1 = 1
scale = 0.2,0.3

[State 0, AssertSpecial]
type = AssertSpecial
trigger1 = 1
flag = noshadow

[State 1011, 1]
type = HitDef
fall.yvelocity = -6
trigger1 = time%10 = 0
attr = S, NA
damage = 60, 20
getpower = 0,0
givepower = 0,0
animtype = Light
guardflag = MA
hitflag = MAF
priority = 3, Hit
pausetime = 0, 8
sparkno = 1402
hitsound = 5432, 5342
guardsound = 654265, 1345
ground.type = High
ground.slidetime = 5
ground.hittime  = 100
ground.velocity = -1,5
airguard.velocity = -1.9,-.8
air.type = High
air.velocity = -1,5
air.hittime = 100
ground.cornerpush.veloff = 0
air.cornerpush.veloff = 0
down.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
envshake.time = 30
envshake.freq = 30
envshake.ampl = -7
envshake.phase = 10
fall = 1
fall.recover = 0
palfx.time = 30
palfx.add = 240,50,0
palfx.mul = 250,224,120
palfx.sinadd = 110,55,85,10

 [State 1011, Destroyself]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
;Karasu  (Kurohigi Kiki Ippatsu)
[Statedef 42400]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= I                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 42400                     ;Change animation (Def: no change)
poweradd = 0
velset = 0,0                    ;Power to add (Def: 0)
sprpriority = 3                  ;Set p1's sprite layering priority to 2 (in front)

[State 0, SuperPause]
type = SuperPause
trigger1 = helper(60001),time = 0
trigger1 = helper(60001),stateno = 62410
time = 1110
movetime = 1110
anim = -1
sound =  0,-1
darken = 0
unhittable = 0

[State 0, Turn]
type = Turn
trigger1 = facing = -1

[State 0, Trans]
type = Trans
trigger1 = time = [40,168]
trans = addalpha
alpha = 256-(time-40)*2,(time-40)*2

[State 0, Trans]
type = Trans
trigger1 = time >= 168
trans = addalpha
alpha = 0,256

[State 0, Helper]
type = Helper
trigger1 = animelem = 4
helpertype = normal
name = "hand1-left"
ID = 42410
stateno = 42410
pos = -15,-27
postype = p1
facing = 1
ownpal = 1
supermovetime = 99999

[State 0, Helper]
type = Helper
trigger1 = animelem = 4
helpertype = normal
name = "hand1-right"
ID = 42411
stateno = 42410
pos = 11,-19
postype = p1
facing = -1
ownpal = 1
supermovetime = 99999

[State 0, Helper]
type = Helper
trigger1 = animelem = 4
helpertype = normal
name = "hand2-left"
ID = 42420
stateno = 42420
pos = -13,-16
postype = p1
facing = 1
ownpal = 1
supermovetime = 99999

[State 0, Helper]
type = Helper
trigger1 = animelem = 4
helpertype = normal
name = "hand2-right"
ID = 42421
stateno = 42420
pos = 7,-11
postype = p1
facing = -1
ownpal = 1
supermovetime = 99999

[State 0, Helper]
type = Helper
trigger1 = animelem = 4
helpertype = normal
name = "head"
ID = 42430
stateno = 42430
pos = 4,-38
postype = p1
facing = 1
ownpal = 1
supermovetime = 99999

[State 0, Helper]
type = Helper
trigger1 = animelem = 4
helpertype = normal
name = "leg-left"
ID = 42440
stateno = 42440
pos = -18,-12
postype = p1
facing = 1
ownpal = 1
supermovetime = 99999

[State 0, Helper]
type = Helper
trigger1 = animelem = 4
helpertype = normal
name = "leg-right"
ID = 42441
stateno = 42440
pos = 9,-13
postype = p1
facing = -1
ownpal = 1
supermovetime = 99999

[State 0, PosSet]
type = PosSet
trigger1 = time = 170
x = helper(60001), pos x
y = -100

[State 1003, ChangeState]
type = changestate
trigger1 =  helper(60001), anim = 62421
value = 42450

;---------------------------------------------------------------------------
;Karasu  (hand1)
[Statedef 42410]
movetype= I                      ;Move-type: A-attack, I-idle, H-gethit
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 42410                     ;Change animation (Def: no change)
poweradd = 0
velset = 0,0                    ;Power to add (Def: 0)
sprpriority = 2

[State 1640, X]
Type=VarSet
Trigger1= time = 0
trigger1= ishelper(42410)
fvar(13)=(helper(60001),Pos X-Pos X)*Facing -35*facing

[State 1640, X]
Type=VarSet
Trigger1= time = 0
trigger1= ishelper(42411)
fvar(13)=(helper(60001),Pos X-Pos X)*Facing +35*facing

[State 1640, Y]
Type=VarSet
trigger1= time = 0
fvar(14)=(helper(60001),Pos Y-Pos Y)-70


[State 1640, Vector Length]
Type=VarSet
trigger1= time = 0
fvar(15)=Exp(0.5*ln((fvar(13)*fvar(13))+(fvar(14)*fvar(14))))

[State 0, VelSet]
type=VelSet
trigger1= time = 7
x= Fvar(13)/fvar(15)*3
y= FVar(14)/fvar(15)*3

[State 0, VelSet]
type=VelSet
trigger1= ishelper(42410)
trigger1= pos x = [helper(60001),Pos X-37,helper(60001),Pos X-33]
x= 0
y= 0

[State 0, VelSet]
type=VelSet
trigger1= ishelper(42411)
trigger1= pos x = [helper(60001),Pos X+33,helper(60001),Pos X+37]
x= 0
y= 0

[State 0, ChangeAnim]
type = ChangeAnim
;trigger1 = root, anim = 32410
;trigger1 = anim != 42411
trigger1 = time = 290 && ishelper(42410)
trigger2 = time = 370 && ishelper(42411)
value = 42411

[State 1003, ChangeState]
type = changestate
trigger1 =  root, anim = 32420
value = 42411

;---------------------------------------------------------------------------
;Karasu  (hand1)
[Statedef 42411]
movetype= I                      ;Move-type: A-attack, I-idle, H-gethit
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 42412                     ;Change animation (Def: no change)
poweradd = 0
velset = 0,0                    ;Power to add (Def: 0)
sprpriority = 2


[State 1640, X]
Type=VarSet
Trigger1= time = 0
fvar(13)=(helper(60001),Pos X-Pos X)*Facing

[State 1640, Y]
Type=VarSet
trigger1= time = 0
fvar(14)=(helper(60001),Pos Y-Pos Y)-10

[State 1640, Vector Length]
Type=VarSet
trigger1= time = 0
fvar(15)=Exp(0.5*ln((fvar(13)*fvar(13))+(fvar(14)*fvar(14))))

[State 0, VelSet]
type=VelSet
trigger1= time = 7
x= Fvar(13)/fvar(15)*10
y= FVar(14)/fvar(15)*10

[State 1003, ChangeState]
type = destroyself
trigger1 =  time = 12

;---------------------------------------------------------------------------
;Karasu  (hand2)
[Statedef 42420]
movetype= I                      ;Move-type: A-attack, I-idle, H-gethit
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 42420                     ;Change animation (Def: no change)
poweradd = 0
velset = 0,0                    ;Power to add (Def: 0)
sprpriority = 2


[State 1640, X]
Type=VarSet
Trigger1= time = 0
trigger1= ishelper(42420)
fvar(13)=(helper(60001),Pos X-Pos X)*Facing -55*facing

[State 1640, X]
Type=VarSet
Trigger1= time = 0
trigger1= ishelper(42421)
fvar(13)=(helper(60001),Pos X-Pos X)*Facing +55*facing

[State 1640, Y]
Type=VarSet
trigger1= time = 0
fvar(14)=(helper(60001),Pos Y-Pos Y)-50

[State 1640, Vector Length]
Type=VarSet
trigger1= time = 0
fvar(15)=Exp(0.5*ln((fvar(13)*fvar(13))+(fvar(14)*fvar(14))))

[State 0, VelSet]
type=VelSet
trigger1= time = 7
x= Fvar(13)/fvar(15)*3
y= FVar(14)/fvar(15)*3

[State 0, VelSet]
type=VelSet
trigger1= ishelper(42420)
trigger1= pos x = [helper(60001),Pos X-57,helper(60001),Pos X-53]
x= 0
y= 0

[State 0, VelSet]
type=VelSet
trigger1= ishelper(42421)
trigger1= pos x = [helper(60001),Pos X+53,helper(60001),Pos X+57]
x= 0
y= 0

[State 0, ChangeAnim]
type = ChangeAnim
;trigger1 = root, anim = 32410
;trigger1 = anim != 42421
trigger1 = time = 400 && ishelper(42420)
trigger2 = time = 430 && ishelper(42421)
value = 42421

[State 1003, ChangeState]
type = changestate
trigger1 = root, anim = 32420
value = 42421

;---------------------------------------------------------------------------
;Karasu  (hand1)
[Statedef 42421]
movetype= I                      ;Move-type: A-attack, I-idle, H-gethit
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 42422                     ;Change animation (Def: no change)
poweradd = 0
velset = 0,0                    ;Power to add (Def: 0)
sprpriority = 2


[State 1640, X]
Type=VarSet
Trigger1= time = 0
fvar(13)=(helper(60001),Pos X-Pos X)*Facing

[State 1640, Y]
Type=VarSet
trigger1= time = 0
fvar(14)=(helper(60001),Pos Y-Pos Y)-10

[State 1640, Vector Length]
Type=VarSet
trigger1= time = 0
fvar(15)=Exp(0.5*ln((fvar(13)*fvar(13))+(fvar(14)*fvar(14))))

[State 0, VelSet]
type=VelSet
trigger1= time = 7
x= Fvar(13)/fvar(15)*10
y= FVar(14)/fvar(15)*10

[State 1003, ChangeState]
type = destroyself
trigger1 =  time = 12

;---------------------------------------------------------------------------
;Karasu  (head)
[Statedef 42430]
movetype= I                      ;Move-type: A-attack, I-idle, H-gethit
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 42430                     ;Change animation (Def: no change)
poweradd = 0
velset = 0,0                    ;Power to add (Def: 0)
sprpriority = 2


[State 1640, X]
Type=VarSet
Trigger1= time = 0
fvar(13)=(helper(60001),Pos X-Pos X)*Facing

[State 1640, Y]
Type=VarSet
trigger1= time = 0
fvar(14)=(helper(60001),Pos Y-Pos Y)-105

[State 1640, Vector Length]
Type=VarSet
trigger1= time = 0
fvar(15)=Exp(0.5*ln((fvar(13)*fvar(13))+(fvar(14)*fvar(14))))

[State 0, VelSet]
type=VelSet
trigger1= time = 7
x= Fvar(13)/fvar(15)*3
y= FVar(14)/fvar(15)*3

[State 0, VelSet]
type=VelSet
trigger1= pos x = [helper(60001),Pos X-2,helper(60001),Pos X+2]
x= 0
y= 0

[State 0, ChangeAnim]
type = ChangeAnim
;trigger1 = root, anim = 32410
;trigger1 = anim != 42431
trigger1 = time = 590
value = 42431

[State 1003, ChangeState]
type = changestate
trigger1 =  root, anim = 32420
value = 42431

;---------------------------------------------------------------------------
;Karasu  (hand1)
[Statedef 42431]
movetype= I                      ;Move-type: A-attack, I-idle, H-gethit
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 42432                     ;Change animation (Def: no change)
poweradd = 0
velset = 0,0                    ;Power to add (Def: 0)
sprpriority = 2


[State 1640, X]
Type=VarSet
Trigger1= time = 0
fvar(13)=(helper(60001),Pos X-Pos X)*Facing

[State 1640, Y]
Type=VarSet
trigger1= time = 0
fvar(14)=(helper(60001),Pos Y-Pos Y)-10

[State 1640, Vector Length]
Type=VarSet
trigger1= time = 0
fvar(15)=Exp(0.5*ln((fvar(13)*fvar(13))+(fvar(14)*fvar(14))))

[State 0, VelSet]
type=VelSet
trigger1= time = 7
x= Fvar(13)/fvar(15)*10
y= FVar(14)/fvar(15)*10

[State 1003, ChangeState]
type = destroyself
trigger1 =  time = 12

;---------------------------------------------------------------------------
;Karasu  (leg)
[Statedef 42440]
movetype= I                      ;Move-type: A-attack, I-idle, H-gethit
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 42440                     ;Change animation (Def: no change)
poweradd = 0
velset = 0,0                    ;Power to add (Def: 0)
sprpriority = 2


[State 1640, X]
Type=VarSet
Trigger1= time = 0
trigger1= ishelper(42440)
fvar(13)=(helper(60001),Pos X-Pos X)*Facing -70*facing

[State 1640, X]
Type=VarSet
Trigger1= time = 0
trigger1= ishelper(42441)
fvar(13)=(helper(60001),Pos X-Pos X)*Facing +70*facing

[State 1640, Y]
Type=VarSet
trigger1= time = 0
fvar(14)=(helper(60001),Pos Y-Pos Y)-30

[State 1640, Vector Length]
Type=VarSet
trigger1= time = 0
fvar(15)=Exp(0.5*ln((fvar(13)*fvar(13))+(fvar(14)*fvar(14))))

[State 0, VelSet]
type=VelSet
trigger1= time = 7
x= Fvar(13)/fvar(15)*3
y= FVar(14)/fvar(15)*3

[State 0, VelSet]
type=VelSet
trigger1= ishelper(42440)
trigger1= pos x = [helper(60001),Pos X-72,helper(60001),Pos X-68]
x= 0
y= 0

[State 0, VelSet]
type=VelSet
trigger1= ishelper(42441)
trigger1= pos x = [helper(60001),Pos X+68,helper(60001),Pos X+72]
x= 0
y= 0

[State 0, ChangeAnim]
type = ChangeAnim
;trigger1 = root, anim = 32410
;trigger1 = anim != 42441
trigger1= time = 520 && ishelper(42440)
trigger2= time = 550 && ishelper(42441)
value = 42441

[State 1003, ChangeState]
type = changestate
trigger1 =  root, anim = 32420
value = 42441

;---------------------------------------------------------------------------
;Karasu  (hand1)
[Statedef 42441]
movetype= I                      ;Move-type: A-attack, I-idle, H-gethit
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 42442                     ;Change animation (Def: no change)
poweradd = 0
velset = 0,0                    ;Power to add (Def: 0)
sprpriority = 2


[State 1640, X]
Type=VarSet
Trigger1= time = 0
fvar(13)=(helper(60001),Pos X-Pos X)*Facing

[State 1640, Y]
Type=VarSet
trigger1= time = 0
fvar(14)=(helper(60001),Pos Y-Pos Y)-10

[State 1640, Vector Length]
Type=VarSet
trigger1= time = 0
fvar(15)=Exp(0.5*ln((fvar(13)*fvar(13))+(fvar(14)*fvar(14))))

[State 0, VelSet]
type=VelSet
trigger1= time = 7
x= Fvar(13)/fvar(15)*10
y= FVar(14)/fvar(15)*10

[State 1003, ChangeState]
type = destroyself
trigger1 =  time = 12

;---------------------------------------------------------------------------
;Karasu  (Kurohigi Kiki Ippatsu)
[Statedef 42450]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= I                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0                         ;Set ctrl (Def: no change)
anim = 42405                     ;Change animation (Def: no change)
poweradd = 0
velset = 0,0                    ;Power to add (Def: 0)
sprpriority = 3  

               ;Set p1's sprite layering priority to 2 (in front)

[State 0, Trans]
type = Trans
trigger1 = time <= 40
trans = addalpha
alpha = (time)*6.4,256-(time)*6.4

[State 0, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
movecamera = 0,0

[State 0, Helper]
type = Helper
trigger1 = time = 0
helpertype = normal
name = "hand1-left"
ID = 42451
stateno = 42455
pos = -19,68
postype = p1
facing = 1
ownpal = 1
supermovetime = 99999

[State 0, Helper]
type = Helper
trigger1 = time = 0
helpertype = normal
name = "hand1-right"
ID = 42451
stateno = 42455
pos = 14,68
postype = p1
facing = -1
ownpal = 1
supermovetime = 99999

[State 0, Helper]
type = Helper
trigger1 = time = 0
helpertype = normal
name = "hand2-left"
ID = 42451
stateno = 42455
pos = -18,79
postype = p1
facing = 1
ownpal = 1
supermovetime = 99999

[State 0, Helper]
type = Helper
trigger1 = time = 0
helpertype = normal
name = "hand2-right"
ID = 42451
stateno = 42455
pos = 12,78
postype = p1
facing = -1
ownpal = 1
supermovetime = 99999

[State 0, Helper]
type = Helper
trigger1 = time = 0
helpertype = normal
name = "head"
ID = 42453
stateno = 42456
pos = -6,38
postype = p1
facing = 1
ownpal = 1
supermovetime = 99999

[State 0, Helper]
type = Helper
trigger1 = time = 0
helpertype = normal
name = "leg-left"
ID = 42454
stateno = 42457
pos = -35,82
postype = p1
facing = 1
ownpal = 1
supermovetime = 99999

[State 0, Helper]
type = Helper
trigger1 = time = 0
helpertype = normal
name = "leg-right"
ID = 42454
stateno = 42457
pos = 28,84
postype = p1
facing = -1
ownpal = 1
supermovetime = 99999

[State 0, PlaySnd]
type = PlaySnd
trigger1 = time%5 = 0
trigger1 = time > 40
value = S2,13

[State 1003, ChangeState]
type = changestate
trigger1 = animtime = 0
value = 40000

;---------------------------------------------------------------------------
; Hand killer end
[Statedef 42455]
movetype= I                      ;Move-type: A-attack, I-idle, H-gethit
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0
anim = 42423                       ;Set ctrl (Def: no change)
poweradd = 0
velset = 0,0                    ;Power to add (Def: 0)
sprpriority = 2                  ;Power to add (Def: 0)


[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 32
value = F24,0+random%5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = random%1
value = S2,10

;[State 0, ChangeAnim]
;type = ChangeAnim
;trigger1 = time = 0
;trigger1 = ishelper = 42451
;value = 42423

;[State 0, ChangeAnim]
;type = ChangeAnim
;trigger1 = time = 0
;trigger1 = ishelper = 42453
;value = 42433

;[State 0, ChangeAnim]
;type = ChangeAnim
;trigger1 = time = 0
;trigger1 = ishelper = 42454
;value = 42443

[State 1640, X]
Type=VarSet
Trigger1= 1
fvar(13)=(parent,Pos X-Pos X)*Facing

[State 1640, Y]
Type=VarSet
trigger1= 1
fvar(14)=(parent,pos Y-Pos Y)-10

[State 1640, Vector Length]
Type=VarSet
trigger1= 1
fvar(15)=Exp(0.5*ln((fvar(13)*fvar(13))+(fvar(14)*fvar(14))))

[State 0, VelSet]
type=VelSet
trigger1= animelem = 5
x= Fvar(13)/fvar(15)*10
y= FVar(14)/fvar(15)*10

[State 0, AngleDraw]
type = Angleset
trigger1 = time > 42
value = (atan(fvar(14)/fvar(13))+(4*Pi/2))*(-180/Pi) + 36

[State 0, AngleDraw]
type = Angledraw
trigger1 = time > 42

[State 0, DestroySelf]
type = DestroySelf
trigger1 = (pos y - parent, pos y) = [-15,0]

;---------------------------------------------------------------------------
; Hand killer end
[Statedef 42456]
movetype= I                      ;Move-type: A-attack, I-idle, H-gethit
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0
anim = 42433                       ;Set ctrl (Def: no change)
poweradd = 0
velset = 0,0                    ;Power to add (Def: 0)
sprpriority = 2                  ;Power to add (Def: 0)


[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 32
value = F24,0+random%5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = random%1
value = S2,10

;[State 0, ChangeAnim]
;type = ChangeAnim
;trigger1 = time = 0
;trigger1 = ishelper = 42451
;value = 42423

;[State 0, ChangeAnim]
;type = ChangeAnim
;trigger1 = time = 0
;trigger1 = ishelper = 42453
;value = 42433

;[State 0, ChangeAnim]
;type = ChangeAnim
;trigger1 = time = 0
;trigger1 = ishelper = 42454
;value = 42443

[State 1640, X]
Type=VarSet
Trigger1= 1
fvar(13)=(parent,Pos X-Pos X)*Facing

[State 1640, Y]
Type=VarSet
trigger1= 1
fvar(14)=(parent,pos Y-Pos Y)-10

[State 1640, Vector Length]
Type=VarSet
trigger1= 1
fvar(15)=Exp(0.5*ln((fvar(13)*fvar(13))+(fvar(14)*fvar(14))))

[State 0, VelSet]
type=VelSet
trigger1= animelem = 5
x= Fvar(13)/fvar(15)*10
y= FVar(14)/fvar(15)*10

[State 0, DestroySelf]
type = DestroySelf
trigger1 = (pos y - parent, pos y) = [-15,0]

;---------------------------------------------------------------------------
; Hand killer end
[Statedef 42457]
movetype= I                      ;Move-type: A-attack, I-idle, H-gethit
juggle  = 1                      ;Number of air juggle points move takes                                ;Commonly-used controllers:
ctrl = 0
anim = 42443                       ;Set ctrl (Def: no change)
poweradd = 0
velset = 0,0                    ;Power to add (Def: 0)
sprpriority = 2                  ;Power to add (Def: 0)


[State 0, PlaySnd]
type = PlaySnd
trigger1 = time = 32
value = F24,0+random%5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = random%1
value = S2,10

;[State 0, ChangeAnim]
;type = ChangeAnim
;trigger1 = time = 0
;trigger1 = ishelper = 42451
;value = 42423

;[State 0, ChangeAnim]
;type = ChangeAnim
;trigger1 = time = 0
;trigger1 = ishelper = 42453
;value = 42433

;[State 0, ChangeAnim]
;type = ChangeAnim
;trigger1 = time = 0
;trigger1 = ishelper = 42454
;value = 42443

[State 1640, X]
Type=VarSet
Trigger1= 1
fvar(13)=(parent,Pos X-Pos X)*Facing

[State 1640, Y]
Type=VarSet
trigger1= 1
fvar(14)=(parent,pos Y-Pos Y)-10

[State 1640, Vector Length]
Type=VarSet
trigger1= 1
fvar(15)=Exp(0.5*ln((fvar(13)*fvar(13))+(fvar(14)*fvar(14))))

[State 0, VelSet]
type=VelSet
trigger1= animelem = 5
x= Fvar(13)/fvar(15)*10
y= FVar(14)/fvar(15)*10

[State 0, AngleDraw]
type = Angleset
trigger1 = time > 42
value = (atan(fvar(14)/fvar(13))+(4*Pi/2))*(-180/Pi) + 36

[State 0, AngleDraw]
type = Angledraw
trigger1 = time > 42

[State 0, DestroySelf]
type = DestroySelf
trigger1 = (pos y - parent, pos y) = [-15,0]





